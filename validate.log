######################################################################################
# NEW TEST: ## /sbin/getenforce ... 
######################################################################################
COMMAND:  /usr/sbin/getenforce
RESULT: Enforcing 
EXPECTED RESULT: Enforcing 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify SELINUX enforcing ... 
######################################################################################
COMMAND:  grep ^SELINUX= /etc/sysconfig/selinux | cut -d\= -f2
RESULT: enforcing 
EXPECTED RESULT: enforcing 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify SELINUXTYPE targeted ... 
######################################################################################
COMMAND:  grep ^SELINUXTYPE= /etc/sysconfig/selinux | cut -d\= -f2
RESULT: targeted 
EXPECTED RESULT: targeted 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Flip Selinux Permissive ... 
######################################################################################
COMMAND:  /usr/sbin/setenforce Permissive && /usr/sbin/getenforce
RESULT: Permissive 
EXPECTED RESULT: Permissive 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Flip Selinux Enforcing ... 
######################################################################################
COMMAND:  /usr/sbin/setenforce Enforcing && /usr/sbin/getenforce
RESULT: Enforcing 
EXPECTED RESULT: Enforcing 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify no missing packages ... 
######################################################################################
COMMAND: /bin/rpm -qa --queryformat='%{NAME}\n' > /tmp/rpmqa.tmp
RETURN CODE: 0
COMMAND: comm -23 /home/whayutin/valid/packages /tmp/rpmqa
RETURN CODE: 0
fonts-KOI8-R
COMMAND:  cat /tmp/package_diff | wc -l
RESULT: 1 
EXPECTED RESULT: 0 
RETURN CODE: 0
FAIL
1
######################################################################################
# NEW TEST: ## Verify GPG checking ... 
######################################################################################
COMMAND:  grep '^gpgcheck=1' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2 | sort -f | uniq
RESULT: 1 
EXPECTED RESULT: 1 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify RPMs ... 
######################################################################################
COMMAND:  cat /tmp/rpmqaV.txt | wc -l
RESULT: 2 
EXPECTED RESULT: 2 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify Version 1 ... 
######################################################################################
COMMAND:  /bin/cat /etc/redhat-release
RESULT: Red Hat Enterprise Linux Server release 5.5 (Tikanga) 
EXPECTED RESULT: Red Hat Enterprise Linux Server release 5.5 (Tikanga) 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify Version 2 ... 
######################################################################################
COMMAND:  /bin/rpm -q --queryformat '%{RELEASE}\n' redhat-release | cut -d. -f1,2
RESULT: 5.5 
EXPECTED RESULT: 5.5 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## install zsh ... 
######################################################################################
COMMAND: /usr/bin/yum -y install zsh
RETURN CODE: 0
COMMAND:  /bin/rpm -q --queryformat '%{NAME}\n' zsh
RESULT: zsh 
EXPECTED RESULT: zsh 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify package removal ... 
######################################################################################
COMMAND: /bin/rpm -e zsh
RETURN CODE: 0
COMMAND:  /bin/rpm -q zsh
RESULT: package zsh is not installed 
EXPECTED RESULT: package zsh is not installed 
RETURN CODE: 1
PASS
######################################################################################
# NEW TEST: ## Verify disks ... 
######################################################################################
COMMAND:  /sbin/parted --list | grep /dev/sda1
RESULT: Disk /dev/sda1: 4096MB 
EXPECTED RESULT: Disk /dev/sda1: 4096MB 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify yum update ... 
######################################################################################
COMMAND:  /usr/bin/yum -y update
RESULT: Loaded plugins: fastestmirror, security
Loading mirror speeds from cached hostfile
 * epel: serverbeach1.fedoraproject.org
Skipping security plugin, no data
Setting up Update Process
No Packages marked for Update 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify disk labels ... 
######################################################################################
COMMAND: cat /etc/fstab | grep /dev/sda1
RETURN CODE: 0
COMMAND:  /sbin/e2label /dev/sda1
RESULT: / 
EXPECTED RESULT: / 
RETURN CODE: 0
PASS
COMMAND: cat /etc/fstab | grep /dev/sdb
RETURN CODE: 0
COMMAND:  /sbin/e2label /dev/sda
/sbin/e2label: No such file or directory while trying to open /dev/sda
Couldn't find valid filesystem superblock.
RESULT:  
EXPECTED RESULT: /mnt 
RETURN CODE: 1
FAIL

######################################################################################
# NEW TEST: ### Verify disk filesystem ... 
######################################################################################
COMMAND:  /sbin/dumpe2fs /dev/sda1
dumpe2fs 1.39 (29-May-2006)
RESULT: Filesystem volume name:   /
Last mounted on:          <not available>
Filesystem UUID:          07a3b964-b8a4-477a-a00d-3408abda104e
Filesystem magic number:  0xEF53
Filesystem revision #:    1 (dynamic)
Filesystem features:      has_journal ext_attr resize_inode dir_index filetype needs_recovery sparse_super large_file
Default mount options:    user_xattr acl
Filesystem state:         clean
Errors behavior:          Continue
Filesystem OS type:       Linux
Inode count:              500960
Block count:              1000038
Reserved block count:     10000
Free blocks:              541094
Free inodes:              424385
First block:              0
Block size:               4096
Fragment size:            4096
Reserved GDT blocks:      244
Blocks per group:         32768
Fragments per group:      32768
Inodes per group:         16160
Inode blocks per group:   505
Filesystem created:       Thu Jul  1 16:10:30 2010
Last mount time:          Fri Jul  2 09:04:38 2010
Last write time:          Fri Jul  2 09:04:38 2010
Mount count:              3
Maximum mount count:      -1
Last checked:             Thu Jul  1 16:10:30 2010
Check interval:           0 (<none>)
Reserved blocks uid:      0 (user root)
Reserved blocks gid:      0 (group root)
First inode:              11
Inode size:		  128
Journal inode:            8
First orphan inode:       32487
Default directory hash:   tea
Directory Hash Seed:      f6221ade-7f16-48f4-8f6d-99571dac5ec3
Journal backup:           inode blocks
Journal size:             64M


Group 0: (Blocks 0-32767)
  Primary superblock at 0, Group descriptors at 1-1
  Reserved GDT blocks at 2-245
  Block bitmap at 246 (+246), Inode bitmap at 247 (+247)
  Inode table at 248-752 (+248)
  15168 free blocks, 16068 free inodes, 2 directories
  Free blocks: 17600-32767
  Free inodes: 93-16160
Group 1: (Blocks 32768-65535)
  Backup superblock at 32768, Group descriptors at 32769-32769
  Reserved GDT blocks at 32770-33013
  Block bitmap at 33014 (+246), Inode bitmap at 33015 (+247)
  Inode table at 33016-33520 (+248)
  30110 free blocks, 16094 free inodes, 2 directories
  Free blocks: 35081-64115, 64461-65535
  Free inodes: 16227-32320
Group 2: (Blocks 65536-98303)
  Block bitmap at 65536 (+0), Inode bitmap at 65537 (+1)
  Inode table at 65538-66042 (+2)
  31845 free blocks, 15997 free inodes, 37 directories
  Free blocks: 66334-69631, 69635-71679, 71681-71683, 71686-71687, 71689-71695, 71698-75775, 75796-75800, 75804-77823, 77825-79871, 79879, 79883, 79886, 79895-81919, 81922, 81926-83968, 83975-86015, 86023, 86026, 86028-88063, 88068-90111, 90114, 90119, 90122-92159, 92167-92175, 92177-92181, 92183, 92191, 92193-92200, 92203-92217, 92220-92221, 92223, 92230-92235, 92241-94215, 94219-96263, 96267-98303
  Free inodes: 32423, 32461-32465, 32471-32472, 32474, 32485, 32494-48480
Group 3: (Blocks 98304-131071)
  Backup superblock at 98304, Group descriptors at 98305-98305
  Reserved GDT blocks at 98306-98549
  Block bitmap at 98550 (+246), Inode bitmap at 98551 (+247)
  Inode table at 98552-99056 (+248)
  28446 free blocks, 15831 free inodes, 1 directories
  Free blocks: 99058-99329, 99331-99491, 99515-100034, 100041-100067, 100148-100149, 100231-100239, 100248-100298, 100444-100461, 100582-100618, 100763-100771, 100862-100864, 100917-101001, 101619-101914, 102098-102119, 102560, 102566, 102568-102623, 102625-102655, 102657-122879, 123783-123909, 124577-131071
  Free inodes: 48483, 48487, 48495, 48500, 48814-64640
Group 4: (Blocks 131072-163839)
  Block bitmap at 131072 (+0), Inode bitmap at 131073 (+1)
  Inode table at 131074-131578 (+2)
  32157 free blocks, 16140 free inodes, 1 directories
  Free blocks: 131683-163839
  Free inodes: 64661-80800
Group 5: (Blocks 163840-196607)
  Backup superblock at 163840, Group descriptors at 163841-163841
  Reserved GDT blocks at 163842-164085
  Block bitmap at 164086 (+246), Inode bitmap at 164087 (+247)
  Inode table at 164088-164592 (+248)
  11650 free blocks, 14422 free inodes, 95 directories
  Free blocks: 166071-166073, 166167-166181, 166464-166466, 166539-166562, 166774-167225, 167757-167761, 167865-167907, 167910-167952, 168916-168925, 168994-169019, 169021-169031, 170007-170103, 170113-170493, 170499-170524, 170554-170861, 170863-170874, 170880-170885, 170891-170903, 170944-170946, 171002-171018, 171108-171168, 171881-171926, 175397-175411, 175758, 175760-175784, 175787-175846, 175850-175984, 176011-176320, 176330-176371, 176558-176582, 176640-176663, 176672-176735, 176743-176745, 176750-176764, 176766-177242, 177244-177270, 178069-178112, 181395-181435, 181437-181455, 181459-181760, 181762-181883, 181927-182017, 182045-182201, 182245-182439, 182447-182460, 182483-182486, 182488-182520, 182543-182544, 182567-182573, 182736-182747, 182751-182814, 182828-182835, 182837-182840, 183053-183113, 183115-183137, 186198-187291, 187296-187364, 187373-187374, 187468-187487, 187491-187497, 187504-187513, 187515-187521, 187523-187553, 187555-187561, 187563-187593, 187595-187657, 187659-187721, 187723-187753, 187755-187761, 187763-188415, 191084-196607
  Free inodes: 80881, 81096-81097, 81099, 81104-81105, 81127, 81130-81137, 81139-81145, 81148-81162, 81165-81167, 81170, 81172-81176, 81180-81183, 81185-81190, 81195, 81197-81199, 81204-81209, 81220, 81231-81232, 81802-81805, 81807-81808, 81810, 81814, 81816-81821, 81834, 81841, 81843-81848, 81851-81858, 81860, 81862, 81864-81869, 81881, 81889-81892, 81904-81905, 81911, 81914-81924, 81926-81928, 81934, 81936-81940, 81943-81948, 81954-81958, 81960-81961, 81982, 81991, 82023, 82025-82026, 82028, 82030-82038, 82040-82045, 82047-82048, 82051-82057, 82060, 82062-82066, 82072-82076, 82080, 82097-82099, 82105-82106, 82108-82118, 82126, 82130, 82157, 82164, 82168-82169, 82171-82172, 82183-82186, 82188-82189, 82690-82692, 82694, 82704, 82741-82751, 82775-96960
Group 6: (Blocks 196608-229375)
  Block bitmap at 196608 (+0), Inode bitmap at 196609 (+1)
  Inode table at 196610-197114 (+2)
  6565 free blocks, 12039 free inodes, 1075 directories
  Free blocks: 198185-198191, 198215-198316, 198767-198770, 198773-198788, 203676-203685, 203888-203893, 203924-203929, 204446-204474, 204729-204955, 204958-204996, 205016-205039, 205406-205423, 205730-205742, 205744-205816, 205861-206016, 206023-206066, 206090-206141, 206711-206751, 206839-206892, 207321-207376, 207450-207488, 207514-207528, 207625-207807, 207810-207816, 207834-207835, 207837-208128, 208137-208138, 208228-208282, 208319-208352, 208449-209268, 209973-210007, 210134-210143, 210150-210176, 210301-210303, 210385-210511, 210524-210563, 210588-210590, 210599-210637, 210651-210697, 210699-210709, 210789-210876, 210886-210896, 210899-211048, 211247-211624, 211660-211770, 211782-211800, 211966-211991, 212014-212109, 212116-212133, 212188-212294, 212299-212314, 212351-212390, 212582-212624, 212626-212683, 212714-212842, 212845-212900, 212902-213120, 213163-213213, 213308-213316, 213319-213572, 213576-213613, 214044-214046, 214068-214083, 214164-214193, 214273-214281, 214283-214461, 214567-214573, 214576-215527, 215552-215578, 215584-215595, 215608-215693, 215704-216018, 216023-216025, 216028-216067, 216228-216237, 216256-216269, 216292-216320, 216354-216373, 216375-216502
  Free inodes: 101082-113120
Group 7: (Blocks 229376-262143)
  Backup superblock at 229376, Group descriptors at 229377-229377
  Reserved GDT blocks at 229378-229621
  Block bitmap at 229622 (+246), Inode bitmap at 229623 (+247)
  Inode table at 229624-230128 (+248)
  1 free blocks, 6040 free inodes, 783 directories
  Free blocks: 253953
  Free inodes: 123240-123248, 123250-129280
Group 8: (Blocks 262144-294911)
  Block bitmap at 262144 (+0), Inode bitmap at 262145 (+1)
  Inode table at 262146-262650 (+2)
  0 free blocks, 14585 free inodes, 218 directories
  Free blocks: 
  Free inodes: 130856-145440
Group 9: (Blocks 294912-327679)
  Backup superblock at 294912, Group descriptors at 294913-294913
  Reserved GDT blocks at 294914-295157
  Block bitmap at 295158 (+246), Inode bitmap at 295159 (+247)
  Inode table at 295160-295664 (+248)
  2348 free blocks, 10186 free inodes, 88 directories
  Free blocks: 318418-318427, 318431-319487, 319515-319788, 320537-321024, 323219-323286, 323505-323741, 325926-325937, 327478-327679
  Free inodes: 150732, 150819, 150833, 150841, 150854, 150866, 150873, 150881-150882, 150884, 150886, 150888, 150890, 150893, 150897-150898, 150921, 150923, 150935, 150937, 150939, 150941, 150999, 151016, 151018, 151020, 151022, 151035-151036, 151047, 151163, 151165, 151169, 151179, 151185, 151187, 151193, 151200, 151202, 151206, 151215, 151222, 151224, 151226, 151233, 151238, 151242, 151246, 151336, 151339, 151345, 151356, 151366, 151383, 151385, 151387, 151389, 151391, 151450, 151472, 151474, 151476-161600
Group 10: (Blocks 327680-360447)
  Block bitmap at 327680 (+0), Inode bitmap at 327681 (+1)
  Inode table at 327682-328186 (+2)
  17499 free blocks, 9516 free inodes, 253 directories
  Free blocks: 342876-346111, 346119, 346127, 346135, 346143, 346151, 346159, 346167, 346175, 346183, 346191, 346195-360447
  Free inodes: 168245-177760
Group 11: (Blocks 360448-393215)
  Block bitmap at 360448 (+0), Inode bitmap at 360449 (+1)
  Inode table at 360450-360954 (+2)
  8414 free blocks, 10060 free inodes, 459 directories
  Free blocks: 362324-362328, 362384-362385, 373801-374315, 377903-377904, 377906-377908, 378042-378060, 378063-378081, 378087-378088, 380509-380525, 380527-380572, 380579-380581, 384088, 384091-384096, 384101-385023, 386365-393215
  Free inodes: 183857-183858, 183863-193920
Group 12: (Blocks 393216-425983)
  Block bitmap at 393216 (+0), Inode bitmap at 393217 (+1)
  Inode table at 393218-393722 (+2)
  1024 free blocks, 10472 free inodes, 425 directories
  Free blocks: 393834, 424882-424883, 424885-424886, 424935-424936, 424942-424947, 424949-424955, 424957-424963, 424965-424972, 424991-424996, 425001-425983
  Free inodes: 199606, 199608, 199610-199612, 199614-210080
Group 13: (Blocks 425984-458751)
  Block bitmap at 425984 (+0), Inode bitmap at 425985 (+1)
  Inode table at 425986-426490 (+2)
  1 free blocks, 11933 free inodes, 1141 directories
  Free blocks: 428558
  Free inodes: 214308-226240
Group 14: (Blocks 458752-491519)
  Block bitmap at 458752 (+0), Inode bitmap at 458753 (+1)
  Inode table at 458754-459258 (+2)
  11760 free blocks, 9473 free inodes, 1034 directories
  Free blocks: 470773-470774, 470778-470789, 470791-470833, 470835-470850, 478316-478318, 479758-483327, 483332-487423, 487431, 487499-491519
  Free inodes: 232582, 232929-242400
Group 15: (Blocks 491520-524287)
  Block bitmap at 491520 (+0), Inode bitmap at 491521 (+1)
  Inode table at 491522-492026 (+2)
  4978 free blocks, 15982 free inodes, 2 directories
  Free blocks: 519310-524287
  Free inodes: 242579-258560
Group 16: (Blocks 524288-557055)
  Block bitmap at 524288 (+0), Inode bitmap at 524289 (+1)
  Inode table at 524290-524794 (+2)
  6425 free blocks, 11672 free inodes, 481 directories
  Free blocks: 524806-524905, 543138-543155, 543175-543180, 543187-543193, 544299-544323, 544396-544397, 544520-544767, 544769, 544771, 544773-546831, 546834-548863, 548941-550810, 550814-550820, 550822-550870, 550959, 552961
  Free inodes: 258568, 258570-258571, 258574, 258576-258578, 258580, 258582-258590, 262650-262651, 262654, 262658, 262978, 262989, 263029, 263031, 263033-263034, 263036, 263038-263039, 263079-274720
Group 17: (Blocks 557056-589823)
  Block bitmap at 557056 (+0), Inode bitmap at 557057 (+1)
  Inode table at 557058-557562 (+2)
  15585 free blocks, 9326 free inodes, 183 directories
  Free blocks: 557580-557589, 557665-557677, 557683-557688, 557701-557710, 558121-558133, 558459-558468, 558489-558490, 558498-558502, 559258, 559260-559262, 569345-569347, 569673-569681, 569729-569739, 570182-570184, 570465-570476, 571273-571282, 571357-571359, 571423-571425, 571656-571710, 571722-571826, 571837-571908, 571910-572060, 572080-572147, 572149-572155, 572157-572186, 572190-572195, 572197-572203, 572205-572235, 572237-572242, 572478-572492, 572494-572500, 572502-572628, 572630-572692, 572694-572700, 572702-572708, 572710-572716, 572718-572732, 572734-572748, 572750-572812, 572814-572820, 572822-572852, 572854-572868, 572870-572996, 572998-573004, 573006-573012, 573014-573028, 573030-573060, 573062-573068, 573070-573513, 573748-577535, 577542-579583, 580659-581653, 581657-587775, 588865-589823
  Free inodes: 281555-290880
Group 18: (Blocks 589824-622591)
  Block bitmap at 589824 (+0), Inode bitmap at 589825 (+1)
  Inode table at 589826-590330 (+2)
  8294 free blocks, 9734 free inodes, 350 directories
  Free blocks: 614259-614260, 614298-614399, 614401-616447, 616449-622591
  Free inodes: 297296, 297308-307040
Group 19: (Blocks 622592-655359)
  Block bitmap at 622592 (+0), Inode bitmap at 622593 (+1)
  Inode table at 622594-623098 (+2)
  8010 free blocks, 15424 free inodes, 79 directories
  Free blocks: 647350-655359
  Free inodes: 307777-323200
Group 20: (Blocks 655360-688127)
  Block bitmap at 655360 (+0), Inode bitmap at 655361 (+1)
  Inode table at 655362-655866 (+2)
  8711 free blocks, 13173 free inodes, 223 directories
  Free blocks: 664755, 673792-673796, 675224-675225, 675343-675345, 675403-675407, 679424-679935, 679945-688127
  Free inodes: 326188-339360
Group 21: (Blocks 688128-720895)
  Block bitmap at 688128 (+0), Inode bitmap at 688129 (+1)
  Inode table at 688130-688634 (+2)
  29622 free blocks, 15517 free inodes, 118 directories
  Free blocks: 690756-696319, 696321-696327, 696329-698367, 698374-698375, 698383, 698391, 698399-698400, 698415-698418, 698423, 698686-702463, 702465-704605, 704609-708607, 708610-708615, 708702-710655, 710773-720895
  Free inodes: 340004-355520
Group 22: (Blocks 720896-753663)
  Block bitmap at 720896 (+0), Inode bitmap at 720897 (+1)
  Inode table at 720898-721402 (+2)
  31241 free blocks, 16096 free inodes, 0 directories
  Free blocks: 722403-737279, 737300-753663
  Free inodes: 355585-371680
Group 23: (Blocks 753664-786431)
  Block bitmap at 753664 (+0), Inode bitmap at 753665 (+1)
  Inode table at 753666-754170 (+2)
  24401 free blocks, 15884 free inodes, 1 directories
  Free blocks: 755578-755689, 755694-755698, 755715-756022, 756030-756043, 756278-756285, 756502-756565, 757226-757233, 758459-758504, 758740-758796, 759099-759232, 759497, 759502-759580, 759590-759696, 759699-759714, 759744-759748, 760062-760089, 760132-760277, 760481-760482, 760606-760615, 760617-760661, 760822-760953, 761207-761391, 761413-761438, 761442-761443, 761562-761608, 761727-761753, 761755-761792, 761795-761810, 761893-761899, 761901-761907, 761926-761939, 761941-761947, 761949-761955, 761957-761963, 761965-762091, 762093-762107, 762109-762139, 762141-762155, 762157-762187, 762189-762203, 762205-762211, 762213-762219, 762221-762227, 762229-762259, 762261-767999, 768001-778239, 780012-786431
  Free inodes: 371783, 371825, 371959-387840
Group 24: (Blocks 786432-819199)
  Block bitmap at 786432 (+0), Inode bitmap at 786433 (+1)
  Inode table at 786434-786938 (+2)
  30901 free blocks, 15967 free inodes, 1 directories
  Free blocks: 788297-808959, 808962-819199
  Free inodes: 388034-404000
Group 25: (Blocks 819200-851967)
  Backup superblock at 819200, Group descriptors at 819201-819201
  Reserved GDT blocks at 819202-819445
  Block bitmap at 819446 (+246), Inode bitmap at 819447 (+247)
  Inode table at 819448-819952 (+248)
  31657 free blocks, 16058 free inodes, 1 directories
  Free blocks: 820311-851967
  Free inodes: 404103-420160
Group 26: (Blocks 851968-884735)
  Block bitmap at 851968 (+0), Inode bitmap at 851969 (+1)
  Inode table at 851970-852474 (+2)
  31800 free blocks, 16063 free inodes, 1 directories
  Free blocks: 852936-884735
  Free inodes: 420258-436320
Group 27: (Blocks 884736-917503)
  Backup superblock at 884736, Group descriptors at 884737-884737
  Reserved GDT blocks at 884738-884981
  Block bitmap at 884982 (+246), Inode bitmap at 884983 (+247)
  Inode table at 884984-885488 (+248)
  31997 free blocks, 16152 free inodes, 1 directories
  Free blocks: 885506-909311, 909313-917503
  Free inodes: 436329-452480
Group 28: (Blocks 917504-950271)
  Block bitmap at 917504 (+0), Inode bitmap at 917505 (+1)
  Inode table at 917506-918010 (+2)
  30990 free blocks, 15962 free inodes, 1 directories
  Free blocks: 919281-944127, 944129-950271
  Free inodes: 452679-468640
Group 29: (Blocks 950272-983039)
  Block bitmap at 950272 (+0), Inode bitmap at 950273 (+1)
  Inode table at 950274-950778 (+2)
  16798 free blocks, 15174 free inodes, 184 directories
  Free blocks: 950805-950807, 950814-950818, 950854, 950859, 950864-950960, 950962-950968, 950970-950976, 950994-951000, 951008, 951501-951503, 951696-951699, 952349, 955708, 955710-955712, 958392-958394, 958404-958463, 958466-958471, 958934-959095, 959910-960070, 960118-960122, 960176-960224, 960240-960402, 960491-960505, 960590-960676, 961064-962559, 962563-962567, 962877-962878, 962880, 962882-964607, 964609-964610, 964619-966655, 966660-966663, 966669-968703, 968710-970751, 970759, 970762-971240, 971242, 971244, 971246-971247, 971250-972799, 972847-972914, 972916-973519, 974849-974855, 976283-976486, 976491, 976493-976895, 976905, 976908-978943, 980993, 981241-981276, 981408-981448, 981451-981454, 981456-981469, 981493-981604, 981639, 981642-981647, 981650-981655, 981674-981679, 981683-981687, 981690-981695, 981697-981703, 981707-981711, 981714-981719, 981721-981727, 981729-981735, 981738-981743, 981745-981746, 981749-981750, 981756-981762, 981764-981783, 981786-981797, 981799-981875, 981877-981878, 981888-981890, 981954-981959, 981962-981967, 981971-981975, 981977-981983, 981985-981991, 981993-981999, 982001-982007, 982012-982015, 982017-982023, 982025-982054, 982056-982058, 982061-982182, 982212-982215, 982217-982223, 982230-982231, 982271, 982273-982279, 982282-982287, 982291-982295, 982297-982303, 982305-982326, 982330-982333, 982337-982368, 982377-982381, 982385-982454, 982456-982461, 982465-982496, 982520-982630, 982632-982758, 982858-982863, 982865-982871, 982873-982879, 982881-982887, 982889-983039
  Free inodes: 469619, 469623, 469625-469626, 469631-484800
Group 30: (Blocks 983040-1000037)
  Block bitmap at 983040 (+0), Inode bitmap at 983041 (+1)
  Inode table at 983042-983546 (+2)
  15831 free blocks, 16074 free inodes, 0 directories
  Free blocks: 984207-1000037
  Free inodes: 484887-500960 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify swap file ... 
######################################################################################
COMMAND:  /sbin/swapoff /dev/sda3 && /sbin/swapon /dev/sda3
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify bash_history
######################################################################################
COMMAND:  cat ~/.bash_history | wc -l 
RESULT: 219 
EXPECTED RESULT: 0 
RETURN CODE: 0
FAIL
219
######################################################################################
# NEW TEST: ## Verify no systemid file ... 
######################################################################################
COMMAND:  echo true
RESULT: true 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify rh-cloud-firstboot is off ... 
######################################################################################
COMMAND:  chkconfig --list | grep rh-cloud | grep -v on
RESULT: rh-cloud-firstboot	0:off	1:off	2:off	3:off	4:off	5:off	6:off 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify nameserver ... 
######################################################################################
COMMAND:  /usr/bin/dig clock.redhat.com 2>> /home/whayutin/valid/validate.log | grep 66.187.233.4  | wc -l
RESULT: 1 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ### Verify group file ... 
######################################################################################
COMMAND:  cat /etc/group | grep root:x:0
RESULT: root:x:0:root 
EXPECTED RESULT: root:x:0:root 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/group | grep bin:x:1
RESULT: bin:x:1:root,bin,daemon 
EXPECTED RESULT: bin:x:1:root,bin,daemon 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/group | grep daemon:x:2
RESULT: daemon:x:2:root,bin,daemon 
EXPECTED RESULT: daemon:x:2:root,bin,daemon 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/group | grep nobody:x:99
RESULT: nobody:x:99: 
EXPECTED RESULT: nobody:x:99: 
RETURN CODE: 0
PASS
COMMAND: useradd test_user
useradd: user test_user exists
RETURN CODE: 9
COMMAND:  cat /etc/group | grep test_user
RESULT: test_user:x:501: 
EXPECTED RESULT: test_user:x:500: 
RETURN CODE: 0
FAIL
test_user:x:501:
######################################################################################
# NEW TEST: ### Verify new passwd file ... 
######################################################################################
COMMAND:  cat /etc/passwd | grep root
RESULT: root:x:0:0:root:/root:/bin/bash
operator:x:11:0:operator:/root:/sbin/nologin 
EXPECTED RESULT: root:x:0:0:root:/root: 
RETURN CODE: 0
FAIL
root:x:0:0:root:/root:/bin/bash operator:x:11:0:operator:/root:/sbin/nologin
COMMAND:  cat /etc/passwd | grep nobody:x:99
RESULT: nobody:x:99:99:Nobody:/:/sbin/nologin 
EXPECTED RESULT: nobody:x:99:99:Nobody:/:/sbin/nologin 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/passwd | grep sshd
RESULT: sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin 
EXPECTED RESULT: sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ### Verify new modprobe.conf file ... 
######################################################################################
COMMAND:  cat /etc/modprobe.conf
RESULT: alias eth0 xennet 
EXPECTED RESULT: alias eth0 xennet 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ### Verify new mtab file ... 
######################################################################################
COMMAND:  cat /etc/mtab | grep /dev/sda1
RESULT: /dev/sda1 / ext3 rw 0 0 
EXPECTED RESULT: /dev/sda1 / ext3 rw 0 0 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ### Verify new shells file ... 
######################################################################################
COMMAND:  cat /etc/shells | grep bash
RESULT: /bin/bash 
EXPECTED RESULT: /bin/bash 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/shells | grep ksh
RESULT: /bin/ksh 
EXPECTED RESULT: /bin/ksh 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/shells | grep nologin
RESULT: /sbin/nologin 
EXPECTED RESULT: /bin/nologin 
RETURN CODE: 0
FAIL
/sbin/nologin
COMMAND:  cat /etc/shells | grep wes
RESULT:  
EXPECTED RESULT: /bin/nologin 
RETURN CODE: 1
FAIL

######################################################################################
# NEW TEST: ### test repo files
######################################################################################
COMMAND:  ls /etc/yum.repos.d/ | wc -l 
RESULT: 7 
EXPECTED RESULT: 5 
RETURN CODE: 0
FAIL
7
COMMAND:  ls /etc/yum.repos.d/redhat* | wc -l
RESULT: 4 
EXPECTED RESULT: 4 
RETURN CODE: 0
PASS
COMMAND:  ls /etc/yum.repos.d/rhel* | wc -l
RESULT: 1 
EXPECTED RESULT: 1 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify disabled yum plugin ... 
######################################################################################
COMMAND:  grep ^enabled /etc/yum/pluginconf.d/rhnplugin.conf | grep -v '^#' | cut -d\= -f2 | awk '{print }' | sort -f | uniq
RESULT:  0 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify IPv6 disabled ... 
######################################################################################
COMMAND:  grep ^NETWORKING_IPV6= /etc/sysconfig/network | cut -d\= -f2
RESULT: no 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify networking ... 
######################################################################################
COMMAND:  grep ^NETWORKING= /etc/sysconfig/network | cut -d\= -f2
RESULT: yes 
EXPECTED RESULT: yes 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify device ... 
######################################################################################
COMMAND:  grep ^DEVICE= /etc/sysconfig/network-scripts/ifcfg-eth0 | cut -d\= -f2
RESULT: eth0 
EXPECTED RESULT: eth0 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify iptables ... 
######################################################################################
COMMAND: /sbin/service iptables status > /tmp/iptables.txt
RETURN CODE: 0
COMMAND:  /usr/bin/diff /home/whayutin/valid/iptables.txt /tmp/iptables.txt
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify all of chkconfig ... 
######################################################################################
COMMAND: /sbin/chkconfig --list > /tmp/chkconfig.txt
RETURN CODE: 0
COMMAND:  /usr/bin/diff /home/whayutin/valid/chkconfig.ec2.i386 /tmp/chkconfig.txt
/usr/bin/diff: /home/whayutin/valid/chkconfig.ec2.i386: No such file or directory
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 2
FAIL

######################################################################################
# NEW TEST: ## Verify syslog is on ... 
######################################################################################
COMMAND:  /sbin/chkconfig --list syslog | grep 3:on
error reading information on service syslog: No such file or directory
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 1
FAIL

COMMAND:  /sbin/chkconfig --list syslog | grep 5:on
error reading information on service syslog: No such file or directory
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 1
FAIL

######################################################################################
# NEW TEST: ## Verify syslog config ... 
######################################################################################
COMMAND:  /usr/bin/diff /home/whayutin/valid/syslog.conf /etc/syslog.conf
/usr/bin/diff: /etc/syslog.conf: No such file or directory
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 2
FAIL

######################################################################################
# NEW TEST: ## Verify auditd is on ... 
######################################################################################
COMMAND:  /sbin/chkconfig --list auditd | grep 3:on
RESULT: auditd         	0:off	1:off	2:on	3:on	4:on	5:on	6:off 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
COMMAND:  /sbin/chkconfig --list auditd | grep 5:on
RESULT: auditd         	0:off	1:off	2:on	3:on	4:on	5:on	6:off 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify audit.rules ... 
######################################################################################
COMMAND:  /usr/bin/diff /home/whayutin/valid/audit.rules /etc/audit/audit.rules
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify auditd.conf ... 
######################################################################################
COMMAND:  /usr/bin/diff /home/whayutin/valid/auditd.conf /etc/audit/auditd.conf
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify auditd sysconfig ... 
######################################################################################
COMMAND:  /usr/bin/diff /home/whayutin/valid/auditd /etc/sysconfig/auditd
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify kernel name ... 
######################################################################################
COMMAND:  /bin/uname -s
RESULT: Linux 
EXPECTED RESULT: Linux 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify kernel release ... 
######################################################################################
COMMAND:  /bin/uname -r | sed -e 's/xen$//g'
RESULT: 2.6.18-194.8.1.el5 
EXPECTED RESULT: 2.6.18-194.8.1.el5 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify operating system ... 
######################################################################################
COMMAND:  /bin/uname -o
RESULT: GNU/Linux 
EXPECTED RESULT: GNU/Linux 
RETURN CODE: 0
PASS
