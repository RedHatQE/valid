######################################################################################
# NEW TEST: ## /sbin/getenforce ... 
######################################################################################
COMMAND:  /usr/sbin/getenforce
RESULT: Enforcing 
EXPECTED RESULT: Enforcing 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify SELINUX enforcing ... 
######################################################################################
COMMAND:  grep ^SELINUX= /etc/sysconfig/selinux | cut -d\= -f2
RESULT: enforcing 
EXPECTED RESULT: enforcing 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify SELINUXTYPE targeted ... 
######################################################################################
COMMAND:  grep ^SELINUXTYPE= /etc/sysconfig/selinux | cut -d\= -f2
RESULT: targeted 
EXPECTED RESULT: targeted 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Flip Selinux Permissive ... 
######################################################################################
COMMAND:  /usr/sbin/setenforce Permissive && /usr/sbin/getenforce
RESULT: Permissive 
EXPECTED RESULT: Permissive 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Flip Selinux Enforcing ... 
######################################################################################
COMMAND:  /usr/sbin/setenforce Enforcing && /usr/sbin/getenforce
RESULT: Enforcing 
EXPECTED RESULT: Enforcing 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify no missing packages ... 
######################################################################################
COMMAND: /bin/rpm -qa --queryformat='%{NAME}\n' > /tmp/rpmqa.tmp
RETURN CODE: 0
COMMAND: comm -23 /home/whayutin/valid/packages /tmp/rpmqa
RETURN CODE: 0
fonts-KOI8-R
yum-utils
COMMAND:  cat /tmp/package_diff | wc -l
RESULT: 2 
EXPECTED RESULT: 0 
RETURN CODE: 0
FAIL
2
######################################################################################
# NEW TEST: ## Verify GPG checking ... 
######################################################################################
COMMAND:  grep '^gpgcheck=1' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2 | sort -f | uniq
RESULT: 1 
EXPECTED RESULT: 1 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify GPG Keys ... 
######################################################################################
COMMAND:  rpm -qa gpg-pubkey* | wc -l 
RESULT: 3 
EXPECTED RESULT: 3 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify GPG RPMS ... 
######################################################################################
COMMAND:  rpm -qa gpg-pubkey* | tail -n 1
RESULT: gpg-pubkey-37017186-45761324 
EXPECTED RESULT: gpg-pubkey-37017186-45761324 
RETURN CODE: 0
PASS
COMMAND:  rpm -qa gpg-pubkey* | tail -n 2 | grep 45e
RESULT: gpg-pubkey-217521f6-45e8a532 
EXPECTED RESULT: gpg-pubkey-217521f6-45e8a532 
RETURN CODE: 0
PASS
COMMAND:  rpm -qa gpg-pubkey* | tail -n 3 | grep 2fa6
RESULT: gpg-pubkey-2fa658e0-45700c69 
EXPECTED RESULT: gpg-pubkey-2fa658e0-45700c69 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify RPMs ... 
######################################################################################
....L...  c /etc/pam.d/system-auth
.M......  c /etc/sysconfig/iptables-config
    S file Size differs
    M Mode differs (includes permissions and file type)
    5 MD5 sum differs
    D Device major/minor number mismatch
    L readLink(2) path mismatch
    U User ownership differs
    G Group ownership differs
    T mTime differs

COMMAND:  cat /tmp/rpmqaV.txt | wc -l
RESULT: 2 
EXPECTED RESULT: 2 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify Version 1 ... 
######################################################################################
COMMAND:  /bin/cat /etc/redhat-release
RESULT: Red Hat Enterprise Linux Server release 5.5 (Tikanga) 
EXPECTED RESULT: Red Hat Enterprise Linux Server release 5.5 (Tikanga) 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify Version 2 ... 
######################################################################################
COMMAND:  /bin/rpm -q --queryformat '%{RELEASE}\n' redhat-release | cut -d. -f1,2
RESULT: 5.5 
EXPECTED RESULT: 5.5 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## install zsh ... 
######################################################################################
COMMAND: /usr/bin/yum -y install zsh
There are unfinished transactions remaining. You might consider running yum-complete-transaction first to finish them.
The program yum-complete-transaction is found in the yum-utils package.
RETURN CODE: 0
COMMAND:  /bin/rpm -q --queryformat '%{NAME}\n' zsh
RESULT: zsh 
EXPECTED RESULT: zsh 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify package removal ... 
######################################################################################
COMMAND: /bin/rpm -e zsh
RETURN CODE: 0
COMMAND:  /bin/rpm -q zsh
RESULT: package zsh is not installed 
EXPECTED RESULT: package zsh is not installed 
RETURN CODE: 1
PASS
######################################################################################
# NEW TEST: ## Verify disks ... 
######################################################################################
COMMAND:  /sbin/parted --list | grep /dev/sda1
RESULT: Disk /dev/sda1: 4096MB 
EXPECTED RESULT: Disk /dev/sda1: 4096MB 
RETURN CODE: 0
PASS
COMMAND:  /sbin/parted --list | grep /dev/sda2
RESULT: Disk /dev/sda2: 160GB 
EXPECTED RESULT: Disk /dev/sda2: 160GB 
RETURN CODE: 0
PASS
COMMAND:  /sbin/parted --list | grep /dev/sda3
RESULT: Disk /dev/sda3: 940MB 
EXPECTED RESULT: Disk /dev/sda3: 940MB 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify yum update ... 
######################################################################################
COMMAND:  /usr/bin/yum -y update
RESULT: Loaded plugins: fastestmirror, security
Loading mirror speeds from cached hostfile
Skipping security plugin, no data
Setting up Update Process
No Packages marked for Update 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify disk labels ... 
######################################################################################
COMMAND: cat /etc/fstab | grep /dev/sda1
RETURN CODE: 0
COMMAND:  /sbin/e2label /dev/sda1
RESULT: / 
EXPECTED RESULT: / 
RETURN CODE: 0
PASS
COMMAND:  /sbin/e2label /dev/sda2
RESULT:  
EXPECTED RESULT: /mnt 
RETURN CODE: 0
FAIL

######################################################################################
# NEW TEST: ### Verify disk filesystem ... 
######################################################################################
COMMAND:  /sbin/dumpe2fs /dev/sda1
dumpe2fs 1.39 (29-May-2006)
RESULT: Filesystem volume name:   /
Last mounted on:          <not available>
Filesystem UUID:          b78512d5-13ac-4b35-8707-1b0d98824134
Filesystem magic number:  0xEF53
Filesystem revision #:    1 (dynamic)
Filesystem features:      has_journal ext_attr resize_inode dir_index filetype needs_recovery sparse_super large_file
Default mount options:    user_xattr acl
Filesystem state:         clean
Errors behavior:          Continue
Filesystem OS type:       Linux
Inode count:              500960
Block count:              1000038
Reserved block count:     10000
Free blocks:              522580
Free inodes:              418759
First block:              0
Block size:               4096
Fragment size:            4096
Reserved GDT blocks:      244
Blocks per group:         32768
Fragments per group:      32768
Inodes per group:         16160
Inode blocks per group:   505
Filesystem created:       Fri May  7 09:30:56 2010
Last mount time:          Fri Jul  2 23:57:41 2010
Last write time:          Fri Jul  2 23:57:41 2010
Mount count:              3
Maximum mount count:      -1
Last checked:             Fri May  7 09:30:56 2010
Check interval:           0 (<none>)
Reserved blocks uid:      0 (user root)
Reserved blocks gid:      0 (group root)
First inode:              11
Inode size:		  128
Journal inode:            8
First orphan inode:       277885
Default directory hash:   tea
Directory Hash Seed:      e6ec912f-9723-4b94-acfb-47bd0ce7d2f9
Journal backup:           inode blocks
Journal size:             64M


Group 0: (Blocks 0-32767)
  Primary superblock at 0, Group descriptors at 1-1
  Reserved GDT blocks at 2-245
  Block bitmap at 246 (+246), Inode bitmap at 247 (+247)
  Inode table at 248-752 (+248)
  3298 free blocks, 14809 free inodes, 419 directories
  Free blocks: 25946-25955, 27173-27218, 27454-27510, 28127-28129, 28133-28139, 28489-28516, 28523-28671, 29770-32767
  Free inodes: 1352-16160
Group 1: (Blocks 32768-65535)
  Backup superblock at 32768, Group descriptors at 32769-32769
  Reserved GDT blocks at 32770-33013
  Block bitmap at 33014 (+246), Inode bitmap at 33015 (+247)
  Inode table at 33016-33520 (+248)
  5875 free blocks, 14620 free inodes, 332 directories
  Free blocks: 33540-33541, 33733-33749, 33788-33800, 33817-33829, 48409-48414, 49152, 57700-57701, 58331-61439, 62823-63487, 63489-65535
  Free inodes: 16164, 16208, 16216-16218, 17706-32320
Group 2: (Blocks 65536-98303)
  Block bitmap at 65536 (+0), Inode bitmap at 65537 (+1)
  Inode table at 65538-66042 (+2)
  13997 free blocks, 9118 free inodes, 1106 directories
  Free blocks: 66166-66171, 66191-66196, 66203-66209, 66213-66215, 66232-66330, 66363-66394, 66404-66405, 66413-66416, 66418, 71078, 71080, 75094-75097, 75769-75775, 75798, 75801-75810, 76737-76750, 79865-79871, 79875, 80331-81919, 81927-81930, 81940-81941, 81943-81944, 81950-83967, 83975, 83978-86015, 86017-88063, 88071, 88076-90111, 90113-92159, 92197-92204, 92210-94207
  Free inodes: 34195, 39364-48480
Group 3: (Blocks 98304-131071)
  Backup superblock at 98304, Group descriptors at 98305-98305
  Reserved GDT blocks at 98306-98549
  Block bitmap at 98550 (+246), Inode bitmap at 98551 (+247)
  Inode table at 98552-99056 (+248)
  19860 free blocks, 14524 free inodes, 226 directories
  Free blocks: 99061-99065, 99069-99095, 99109-99121, 99133-99140, 99161-99702, 99704-99857, 99902-99934, 99936-99938, 100460-101041, 101348-101375, 101410-101670, 102160-102200, 102239-102399, 102402-102679, 103152-103153, 103366-103383, 103388-103417, 103424-103480, 103500-103538, 103545-103578, 103625-103648, 103790-103806, 103885-103903, 104014, 104021, 104037, 109494-116735, 116737-126975
  Free inodes: 48497, 48507-48508, 48515-48519, 48521-48522, 48567-48568, 48574-48576, 48583-48589, 48636-48639, 48654-48659, 48676-48677, 48683-48686, 48688-48692, 48694-48697, 48699-48700, 48702, 48706-48709, 48734-48737, 48781-48782, 50177-64640
Group 4: (Blocks 131072-163839)
  Block bitmap at 131072 (+0), Inode bitmap at 131073 (+1)
  Inode table at 131074-131578 (+2)
  27461 free blocks, 16066 free inodes, 0 directories
  Free blocks: 131651-131653, 131758-131775, 131777-131778, 131797-131804, 136381-159743, 159773-163839
  Free inodes: 64650, 64698-64699, 64702, 64706-64707, 64711, 64742-80800
Group 5: (Blocks 163840-196607)
  Backup superblock at 163840, Group descriptors at 163841-163841
  Reserved GDT blocks at 163842-164085
  Block bitmap at 164086 (+246), Inode bitmap at 164087 (+247)
  Inode table at 164088-164592 (+248)
  31606 free blocks, 16085 free inodes, 0 directories
  Free blocks: 164636-164637, 164825-164837, 164877-164885, 164888-164897, 165026-192511, 192522-196607
  Free inodes: 80809-80810, 80844-80845, 80852-80853, 80857, 80883-96960
Group 6: (Blocks 196608-229375)
  Block bitmap at 196608 (+0), Inode bitmap at 196609 (+1)
  Inode table at 196610-197114 (+2)
  28728 free blocks, 16064 free inodes, 2 directories
  Free blocks: 197201, 197310-197323, 197340-197347, 197349-197352, 198523, 198566-202751, 202753-208895, 209240-219135, 219725-225279, 226456-229375
  Free inodes: 97057-113120
Group 7: (Blocks 229376-262143)
  Backup superblock at 229376, Group descriptors at 229377-229377
  Reserved GDT blocks at 229378-229621
  Block bitmap at 229622 (+246), Inode bitmap at 229623 (+247)
  Inode table at 229624-230128 (+248)
  3847 free blocks, 15906 free inodes, 0 directories
  Free blocks: 257042-257044, 257178-257184, 257834-257869, 257881-257907, 257972-257995, 258001-258047, 258049-258095, 258488-262143
  Free inodes: 113207, 113223-113226, 113314-113317, 113319-113321, 113332-113335, 113391-129280
Group 8: (Blocks 262144-294911)
  Block bitmap at 262144 (+0), Inode bitmap at 262145 (+1)
  Inode table at 262146-262650 (+2)
  31854 free blocks, 16100 free inodes, 0 directories
  Free blocks: 262661-263248, 263339, 263426-263430, 263571-263577, 263594-263597, 263599-263602, 263663-290815, 290820-294911
  Free inodes: 129283, 129295, 129312, 129327, 129331, 129333, 129347-145440
Group 9: (Blocks 294912-327679)
  Backup superblock at 294912, Group descriptors at 294913-294913
  Reserved GDT blocks at 294914-295157
  Block bitmap at 295158 (+246), Inode bitmap at 295159 (+247)
  Inode table at 295160-295664 (+248)
  31688 free blocks, 16087 free inodes, 0 directories
  Free blocks: 295686, 295851-295859, 295885-295894, 295896-295921, 296006-323583, 323616-327679
  Free inodes: 145472, 145478-145479, 145481, 145518-161600
Group 10: (Blocks 327680-360447)
  Block bitmap at 327680 (+0), Inode bitmap at 327681 (+1)
  Inode table at 327682-328186 (+2)
  25341 free blocks, 14287 free inodes, 191 directories
  Free blocks: 328519-328520, 328698-328701, 329272-329275, 329432-329438, 329953-329956, 329980-329989, 329997-329999, 330564, 330567-330570, 330572-330579, 330582-330589, 330617-330667, 330680-330682, 330684-330688, 330763-330982, 330985-331023, 331435, 331439-331470, 331487-331488, 331490-331501, 331529-331530, 331544, 331554, 331590-331591, 331739-331746, 331752, 331754, 331765, 331769-331770, 331772-331775, 331777, 331791, 331793-331798, 331800-331806, 331811-331814, 331816-331822, 331825-331831, 331843, 331850-331851, 331875, 331877-333823, 333829-335871, 335873, 335875-337919, 337921-339967, 339972-342015, 342018-342021, 342023, 342031, 342033-342082, 342086-342119, 342127-342196, 342204-342261, 342287-342320, 342323-342356, 342373-342443, 342460-342496, 342499-342530, 342545-342687, 342699-342786, 342797-343056, 343076-343166, 343169-344063, 344071-344072, 344076-346111, 346118-348159, 348165-350207, 351301-352255, 352257-354303, 354344-355392, 355394-356351, 356355, 356359, 356634-356641, 356711-358399
  Free inodes: 163250-163256, 163334-163339, 163347, 163394-163395, 163475, 163485-163486, 163492-163496, 163498-177760
Group 11: (Blocks 360448-393215)
  Block bitmap at 360448 (+0), Inode bitmap at 360449 (+1)
  Inode table at 360450-360954 (+2)
  24106 free blocks, 16063 free inodes, 1 directories
  Free blocks: 368982-368989, 369020-369025, 369029-369034, 369124-389119, 389126-393215
  Free inodes: 177774-177775, 177817-177818, 177825-177826, 177832, 177865-193920
Group 12: (Blocks 393216-425983)
  Block bitmap at 393216 (+0), Inode bitmap at 393217 (+1)
  Inode table at 393218-393722 (+2)
  31839 free blocks, 16072 free inodes, 0 directories
  Free blocks: 393733-393735, 393817-393818, 394032-394086, 394122-394128, 394131-394135, 394212-421887, 421893-425983
  Free inodes: 193923, 193934-193935, 193976-193982, 193991-193992, 193996, 194022-210080
Group 13: (Blocks 425984-458751)
  Block bitmap at 425984 (+0), Inode bitmap at 425985 (+1)
  Inode table at 425986-426490 (+2)
  32247 free blocks, 16154 free inodes, 0 directories
  Free blocks: 426505-458751
  Free inodes: 210087-226240
Group 14: (Blocks 458752-491519)
  Block bitmap at 458752 (+0), Inode bitmap at 458753 (+1)
  Inode table at 458754-459258 (+2)
  30853 free blocks, 15965 free inodes, 0 directories
  Free blocks: 459275-459278, 459469-459472, 459939-460060, 460160-460185, 460189-460190, 460309-460355, 460451-460468, 460474-460507, 460543-460580, 460585-460611, 460613-460628, 460803-487423, 487626-491519
  Free inodes: 226267-226269, 226351-226365, 226384, 226386, 226388-226391, 226399-226403, 226436, 226441-226442, 226444, 226469-242400
Group 15: (Blocks 491520-524287)
  Block bitmap at 491520 (+0), Inode bitmap at 491521 (+1)
  Inode table at 491522-492026 (+2)
  28820 free blocks, 15873 free inodes, 1 directories
  Free blocks: 492028-492029, 492210-492299, 492301-492461, 492485-493004, 493011-493039, 493121-493180, 493198-493201, 493221-493222, 493254-493258, 493341-493343, 493424-493508, 493530-493533, 494065-494360, 494389-494404, 494469-494490, 494576-494612, 494757-494765, 494828-494831, 494872-494901, 494975-494995, 495000-495028, 495273-495274, 495284, 495290-518143, 519721-520191, 520225-524287
  Free inodes: 242407, 242486, 242598, 242610, 242626-242629, 242643-242646, 242654, 242701-258560
Group 16: (Blocks 524288-557055)
  Block bitmap at 524288 (+0), Inode bitmap at 524289 (+1)
  Inode table at 524290-524794 (+2)
  31626 free blocks, 16054 free inodes, 1 directories
  Free blocks: 524801-524804, 524894, 525267-525312, 525324-525330, 525348-525352, 525354-525371, 525446-552959, 553025-557055
  Free inodes: 258667-274720
Group 17: (Blocks 557056-589823)
  Block bitmap at 557056 (+0), Inode bitmap at 557057 (+1)
  Inode table at 557058-557562 (+2)
  11299 free blocks, 11969 free inodes, 1059 directories
  Free blocks: 558623, 558626, 558652, 558654-558664, 558673, 558714-558716, 558719, 558721-558726, 558753-558763, 558767-558768, 558770-558771, 558774, 558777-558783, 558785-558786, 558788-558789, 558791-558795, 558797, 558800-558811, 558815-558818, 558820, 558827-559014, 559016-559018, 559020, 559022-559026, 559028-559029, 559031-559032, 559035-559036, 559038-560029, 561643-561765, 561786-561791, 562314-562342, 562513-562802, 563169-563186, 563493-563505, 563507-563579, 563624-563779, 563786-563829, 563853-563904, 564474-564514, 564602-564655, 565083-565138, 565223-565261, 565295-565484, 565487-565494, 565591-565626, 565644-565645, 565647-565931, 565968-566029, 566038-566039, 566106-566274, 566298-566331, 566428-567247, 567952-567958, 568085-568094, 568167-568293, 568308-568318, 568320-568358, 568372-568418, 568497-568584, 568594-568604, 568607-568756, 568955-569332, 569344, 569369-569479, 569491-569509, 569675-570008, 570031-570126, 570133-570150, 570205-570311, 570338-570378, 570403-570405, 570413-570451, 570643-570657, 570672-570713, 570715-570772, 570803-570931, 570934-570989, 570991-571209, 571252-571301, 571365, 571397-571406, 571409-571662, 571666-571703, 572134-572136, 572160-572175, 572252-572281, 572363-572371, 572373-572551, 572657-573599, 573602-573628, 573634-573649, 573674-573685, 573698-573783, 573794-574108, 574112-574114, 574117-574155, 574317-574326, 574345-574359, 574382-574410, 574444-574463, 574465-574592, 577867-577903, 577969-577997, 578179-578191, 578200-578206, 578359-578378, 578380-579327, 579329-580142, 580144-580241, 580243-580250, 580252-580338, 580409-580507, 580511-580570, 580581-580606, 581826-581895, 581913-582065, 582431-582483, 582492-582493, 582496-582685, 582804-582848, 582962-582979, 583021-583025, 583177-583195, 583459-583471, 583475-583679, 586150-586168
  Free inodes: 277496, 278913-290880
Group 18: (Blocks 589824-622591)
  Block bitmap at 589824 (+0), Inode bitmap at 589825 (+1)
  Inode table at 589826-590330 (+2)
  82 free blocks, 6252 free inodes, 843 directories
  Free blocks: 592605-592610, 596738-596739, 596741, 596743-596744, 596746, 596749-596761, 606700-606709, 619174-619179, 619186-619201, 619301-619325
  Free inodes: 297966, 297968, 299902-299911, 299927-299929, 300245-300312, 300417-300589, 300614-300615, 300656-300657, 300740-300753, 300837-300841, 301068-307040
Group 19: (Blocks 622592-655359)
  Block bitmap at 622592 (+0), Inode bitmap at 622593 (+1)
  Inode table at 622594-623098 (+2)
  832 free blocks, 12165 free inodes, 586 directories
  Free blocks: 625081-625084, 625086-625090, 625361-625370, 625372-625376, 625378-625379, 625381, 625433-625444, 625477-625732, 625734-625738, 625741-625802, 625804-625860, 625862-625864, 625866-625919, 625944-626051, 637563-637573, 637643-637653, 637664-637666, 637855-637863, 646912-647124, 647785
  Free inodes: 308802, 309542, 309555-309557, 309648-309652, 309668-309672, 311051-323200
Group 20: (Blocks 655360-688127)
  Block bitmap at 655360 (+0), Inode bitmap at 655361 (+1)
  Inode table at 655362-655866 (+2)
  876 free blocks, 8994 free inodes, 185 directories
  Free blocks: 663165-663850, 664584-664588, 669009-669171, 669309-669312, 677712-677713, 678077-678078, 684032-684037, 686338-686342, 686348-686350
  Free inodes: 329588-329591, 329783-329784, 329856, 329868-329869, 330376-339360
Group 21: (Blocks 688128-720895)
  Block bitmap at 688128 (+0), Inode bitmap at 688129 (+1)
  Inode table at 688130-688634 (+2)
  128 free blocks, 9328 free inodes, 298 directories
  Free blocks: 699076-699157, 699183-699208, 701163-701180, 703598, 705799
  Free inodes: 344371, 344373, 345330-345337, 345729, 346204-355520
Group 22: (Blocks 720896-753663)
  Block bitmap at 720896 (+0), Inode bitmap at 720897 (+1)
  Inode table at 720898-721402 (+2)
  680 free blocks, 11073 free inodes, 299 directories
  Free blocks: 721446, 727075, 728828-728845, 734530-734533, 735799, 735806, 738465-738470, 738482-738485, 738497-738499, 739676-739686, 739705-739709, 739720-739729, 741438, 743628-743631, 743754-743756, 743767-743769, 743774-743776, 743804-743818, 743847-743849, 744043, 744484-744487, 744489-744495, 744502-744503, 744509-744511, 744519, 744527, 744553-744559, 745171-745177, 745586-745599, 745602, 745615, 745794-745799, 746330-746348, 746506-746528, 750160-750187, 750354-750370, 750377-750401, 750725-750738, 750762-750765, 750774-750775, 750778-750780, 751075-751076, 751107-751111, 751113-751114, 751242-751247, 751261, 751809, 751816-751871, 751888-751969, 752259-752263, 752425-752449, 752464-752492, 752736-752840, 753559-753632
  Free inodes: 359115-359117, 359123, 359125-359127, 359151-359152, 359164-359165, 359167-359172, 359174-359176, 359178-359179, 359196, 359203, 359205-359210, 359228, 359231-359238, 359240, 359242, 359244-359247, 359273-359274, 359305-359308, 359320-359321, 359327, 359330-359340, 359342-359344, 359352-359356, 359359-359364, 359370-359371, 359389, 359398, 359440-359441, 359445-359452, 359457, 359459-359462, 359464-359466, 359471, 359493-359495, 359501-359502, 359504-359505, 359526, 359546-359551, 359553-359556, 359558-359559, 359561, 359565-359572, 359577, 359598-359602, 359604-359605, 359616-359619, 359621-359622, 359626, 359628-359629, 359644, 359646, 359661, 359672, 359680, 359682-359683, 359717-359720, 359737, 359776-359785, 359827-359828, 359846, 359848-359851, 359855, 359860, 359862-359864, 359866, 359871, 359876-359877, 359880-359883, 359885-359886, 359959-359962, 359981, 359983, 359987, 360047, 360049-360050, 360808-361414, 361417-371680
Group 23: (Blocks 753664-786431)
  Block bitmap at 753664 (+0), Inode bitmap at 753665 (+1)
  Inode table at 753666-754170 (+2)
  1571 free blocks, 11586 free inodes, 385 directories
  Free blocks: 769486-769510, 770487-770488, 774583-774601, 775472-775476, 776269, 776320-777215, 777785, 777790, 777795-777798, 778024-778156, 778212-778257, 784384-784448, 784450-784576, 784607-784719, 784722-784847, 785016-785022
  Free inodes: 375429, 376147, 376249, 376252, 376258-376298, 376300-387840
Group 24: (Blocks 786432-819199)
  Block bitmap at 786432 (+0), Inode bitmap at 786433 (+1)
  Inode table at 786434-786938 (+2)
  2 free blocks, 10864 free inodes, 1141 directories
  Free blocks: 791747-791748
  Free inodes: 389651, 393138-404000
Group 25: (Blocks 819200-851967)
  Backup superblock at 819200, Group descriptors at 819201-819201
  Reserved GDT blocks at 819202-819445
  Block bitmap at 819446 (+246), Inode bitmap at 819447 (+247)
  Inode table at 819448-819952 (+248)
  0 free blocks, 9998 free inodes, 1020 directories
  Free blocks: 
  Free inodes: 408414, 409605-409607, 409657-409661, 409812-409815, 409835-409837, 410025, 410180-420160
Group 26: (Blocks 851968-884735)
  Block bitmap at 851968 (+0), Inode bitmap at 851969 (+1)
  Inode table at 851970-852474 (+2)
  6661 free blocks, 12646 free inodes, 465 directories
  Free blocks: 853872-853892, 853953-853968, 854009-854052, 854112-854118, 854125-854127, 854172-854174, 854227-854244, 854834-854835, 855147, 856603-856604, 857398-857403, 857446-857449, 857453-857455, 857462-857463, 857478-857485, 857504-857505, 857513-857520, 858344-858345, 858349-858361, 858367-858371, 859418-859422, 859755-859756, 862828, 866035-866037, 866379-866412, 866450-866472, 873653-878591, 878599, 879340-879654, 879656-879658, 879679-879730, 880481-880968, 882024-882092, 882195-882197, 882232-882235, 882242, 882252-882267, 882976-883028, 883514-883750, 883756-883803, 883940-883956, 883989-883991, 884562-884735
  Free inodes: 420263, 420344, 422661-422662, 422664-422671, 422681, 423425, 423427, 423431, 423445, 423453, 423455, 423463, 423472, 423474, 423478, 423489, 423498, 423500, 423502, 423509, 423514, 423518, 423522, 423553-423554, 423569-423572, 423577, 423629, 423631-423634, 423637-423639, 423657, 423659, 423671, 423673, 423675, 423679, 423691, 423693, 423695, 423697, 423701-423709, 423711, 423713, 423715, 423720-423726, 423728, 423736, 423744, 423751, 423754-436320
Group 27: (Blocks 884736-917503)
  Backup superblock at 884736, Group descriptors at 884737-884737
  Reserved GDT blocks at 884738-884981
  Block bitmap at 884982 (+246), Inode bitmap at 884983 (+247)
  Inode table at 884984-885488 (+248)
  3521 free blocks, 9915 free inodes, 226 directories
  Free blocks: 902475-902485, 910171-911359, 915183-917503
  Free inodes: 442412, 442486-442686, 442700, 442769-452480
Group 28: (Blocks 917504-950271)
  Block bitmap at 917504 (+0), Inode bitmap at 917505 (+1)
  Inode table at 917506-918010 (+2)
  16339 free blocks, 9429 free inodes, 131 directories
  Free blocks: 920587-920590, 920815-920917, 921075-921124, 921231-921232, 922058-922653, 925211-925220, 925225-925272, 925278-925330, 925398-925406, 925456-926603, 926666-927304, 927383-927388, 927397, 927416-931839, 931860-940695, 944740, 944884-944885, 946275-946279, 946303-946310, 946727-946780, 946816-946827, 947345-947354, 947434-947447, 948739-949042
  Free inodes: 458481, 459167, 459178, 459180, 459204, 459208, 459212, 459219-468640
Group 29: (Blocks 950272-983039)
  Block bitmap at 950272 (+0), Inode bitmap at 950273 (+1)
  Inode table at 950274-950778 (+2)
  5685 free blocks, 9859 free inodes, 435 directories
  Free blocks: 950785-950788, 953737-953753, 953755-953800, 953807-953809, 970186-970191, 970193-970753, 970756-970834, 970935-972412, 973398, 978579-978580, 978821-978823, 979311, 979313-979314, 979549-980991, 981001-983039
  Free inodes: 474761-475495, 475612-475613, 475620-475621, 475681-484800
Group 30: (Blocks 983040-1000037)
  Block bitmap at 983040 (+0), Inode bitmap at 983041 (+1)
  Inode table at 983042-983546 (+2)
  2598 free blocks, 14712 free inodes, 77 directories
  Free blocks: 985115-985506, 985551-985577, 986096-986125, 997089-999158, 999227-999230, 999232, 999241-999246, 999378-999384, 999386-999434, 999495-999498, 999974-999981
  Free inodes: 485159-485259, 485612, 486351-500960 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify swap file ... 
######################################################################################
COMMAND:  /sbin/swapoff /dev/sda3 && /sbin/swapon /dev/sda3
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify bash_history ... 
######################################################################################
COMMAND:  cat ~/.bash_history | wc -l 
RESULT: 122 
EXPECTED RESULT: 0 
RETURN CODE: 0
FAIL
122
######################################################################################
# NEW TEST: ## Verify no systemid file ... 
######################################################################################
COMMAND:  echo true
RESULT: true 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify rh-cloud-firstboot is off ... 
######################################################################################
COMMAND:  chkconfig --list | grep rh-cloud | grep -v on
RESULT: rh-cloud-firstboot	0:off	1:off	2:off	3:off	4:off	5:off	6:off 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify nameserver ... 
######################################################################################
COMMAND:  /usr/bin/dig clock.redhat.com 2>> /home/whayutin/valid/validate.log | grep 66.187.233.4  | wc -l
RESULT: 1 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify group file ... 
######################################################################################
COMMAND:  cat /etc/group | grep root:x:0
RESULT: root:x:0:root 
EXPECTED RESULT: root:x:0:root 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/group | grep bin:x:1
RESULT: bin:x:1:root,bin,daemon 
EXPECTED RESULT: bin:x:1:root,bin,daemon 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/group | grep daemon:x:2
RESULT: daemon:x:2:root,bin,daemon 
EXPECTED RESULT: daemon:x:2:root,bin,daemon 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/group | grep nobody:x:99
RESULT: nobody:x:99: 
EXPECTED RESULT: nobody:x:99: 
RETURN CODE: 0
PASS
COMMAND: useradd test_user
useradd: user test_user exists
RETURN CODE: 9
COMMAND:  cat /etc/group | grep test_user
RESULT: test_user:x:501: 
EXPECTED RESULT: test_user:x:500: 
RETURN CODE: 0
FAIL
test_user:x:501:
######################################################################################
# NEW TEST: ## Verify new passwd file ... 
######################################################################################
COMMAND:  cat /etc/passwd | grep root:x:0
RESULT: root:x:0:0:root:/root:/bin/bash 
EXPECTED RESULT: root:x:0:0:root:/root:/bin/bash 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/passwd | grep nobody:x:99
RESULT: nobody:x:99:99:Nobody:/:/sbin/nologin 
EXPECTED RESULT: nobody:x:99:99:Nobody:/:/sbin/nologin 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/passwd | grep sshd
RESULT: sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin 
EXPECTED RESULT: sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify inittab ... 
######################################################################################
COMMAND:  cat /etc/inittab | grep id:
RESULT: id:3:initdefault: 
EXPECTED RESULT: id:3:initdefault: 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/inittab | grep si:
RESULT: si::sysinit:/etc/rc.d/rc.sysinit 
EXPECTED RESULT: si::sysinit:/etc/rc.d/rc.sysinit 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify new modprobe.conf file ... 
######################################################################################
COMMAND:  cat /etc/modprobe.conf
RESULT: alias eth0 xennet 
EXPECTED RESULT: alias eth0 xennet 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify new mtab file ... 
######################################################################################
COMMAND:  cat /etc/mtab | grep /dev/sda1
RESULT: /dev/sda1 / ext3 rw 0 0 
EXPECTED RESULT: /dev/sda1 / ext3 rw 0 0 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify new shells file ... 
######################################################################################
COMMAND:  cat /etc/shells | grep bash
RESULT: /bin/bash 
EXPECTED RESULT: /bin/bash 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/shells | grep ksh
RESULT: /bin/ksh 
EXPECTED RESULT: /bin/ksh 
RETURN CODE: 0
PASS
COMMAND:  cat /etc/shells | grep nologin
RESULT: /sbin/nologin 
EXPECTED RESULT: /sbin/nologin 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## test repo files ... 
######################################################################################
COMMAND:  ls /etc/yum.repos.d/ | wc -l 
RESULT: 5 
EXPECTED RESULT: 5 
RETURN CODE: 0
PASS
COMMAND:  ls /etc/yum.repos.d/redhat* | wc -l
RESULT: 4 
EXPECTED RESULT: 4 
RETURN CODE: 0
PASS
COMMAND:  ls /etc/yum.repos.d/rhel* | wc -l
RESULT: 1 
EXPECTED RESULT: 1 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify disabled yum plugin ... 
######################################################################################
COMMAND:  grep ^enabled /etc/yum/pluginconf.d/rhnplugin.conf | grep -v '^#' | cut -d\= -f2 | awk '{print }' | sort -f | uniq
RESULT:  0 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify IPv6 disabled ... 
######################################################################################
COMMAND:  grep ^NETWORKING_IPV6= /etc/sysconfig/network | cut -d\= -f2
RESULT: no 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify networking ... 
######################################################################################
COMMAND:  grep ^NETWORKING= /etc/sysconfig/network | cut -d\= -f2
RESULT: yes 
EXPECTED RESULT: yes 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify device ... 
######################################################################################
COMMAND:  grep ^DEVICE= /etc/sysconfig/network-scripts/ifcfg-eth0 | cut -d\= -f2
RESULT: eth0 
EXPECTED RESULT: eth0 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify iptables ... 
######################################################################################
COMMAND: /sbin/service iptables status > /tmp/iptables.txt
RETURN CODE: 0
COMMAND:  /usr/bin/diff /home/whayutin/valid/iptables.txt /tmp/iptables.txt
RESULT: 0a1,4
> Table: mangle
> 
> Table: nat
>  
EXPECTED RESULT:  
RETURN CODE: 1
FAIL
0a1,4 > Table: mangle > > Table: nat >
######################################################################################
# NEW TEST: ## Verify sshd ...
######################################################################################
COMMAND:  chkconfig --list | grep sshd
RESULT: sshd           	0:off	1:off	2:on	3:on	4:on	5:on	6:off 
EXPECTED RESULT: sshd           	0:off	1:off	2:on	3:on	4:on	5:on	6:off 
RETURN CODE: 0
PASS
COMMAND:  /etc/init.d/sshd status | grep running | wc -l
RESULT: 1 
EXPECTED RESULT: 1 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify  chkconfig ... 
######################################################################################
COMMAND:  chkconfig --list | grep crond | cut -f 5
RESULT: 3:on 
EXPECTED RESULT: 3:on 
RETURN CODE: 0
PASS
COMMAND:  chkconfig --list | grep -w syslog | cut -f 5
RESULT: 3:on 
EXPECTED RESULT: 3:on 
RETURN CODE: 0
PASS
COMMAND:  chkconfig --list | grep yum-updatesd | cut -f 5
RESULT: 3:on 
EXPECTED RESULT: 3:on 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify rsyslog is on ... 
######################################################################################
COMMAND:  chkconfig --list | grep rsyslog | cut -f 5
RESULT: 3:off 
EXPECTED RESULT: 3:on 
RETURN CODE: 0
FAIL
3:off
######################################################################################
# NEW TEST: ## Verify rsyslog config ... 
######################################################################################
COMMAND:  md5sum /etc/rsyslog.conf | cut -f 1 -d  " "
RESULT: bd4e328df4b59d41979ef7202a05e074 
EXPECTED RESULT: bd4e328df4b59d41979ef7202a05e074 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify auditd is on ... 
######################################################################################
COMMAND:  /sbin/chkconfig --list auditd | grep 3:on
RESULT: auditd         	0:off	1:off	2:on	3:on	4:on	5:on	6:off 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
COMMAND:  /sbin/chkconfig --list auditd | grep 5:on
RESULT: auditd         	0:off	1:off	2:on	3:on	4:on	5:on	6:off 
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify audit.rules ... 
######################################################################################
COMMAND:  /usr/bin/diff /home/whayutin/valid/audit.rules /etc/audit/audit.rules
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify auditd.conf ... 
######################################################################################
COMMAND:  /usr/bin/diff /home/whayutin/valid/auditd.conf /etc/audit/auditd.conf
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify auditd sysconfig ... 
######################################################################################
COMMAND:  /usr/bin/diff /home/whayutin/valid/auditd /etc/sysconfig/auditd
RESULT:  
EXPECTED RESULT:  
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify kernel name ... 
######################################################################################
COMMAND:  /bin/uname -s
RESULT: Linux 
EXPECTED RESULT: Linux 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify kernel release ... 
######################################################################################
COMMAND:  /bin/uname -r | sed -e 's/xen$//g'
RESULT: 2.6.18-194.3.1.el5 
EXPECTED RESULT: 2.6.18-194.3.1.el5 
RETURN CODE: 0
PASS
######################################################################################
# NEW TEST: ## Verify operating system ... 
######################################################################################
COMMAND:  /bin/uname -o
RESULT: GNU/Linux 
EXPECTED RESULT: GNU/Linux 
RETURN CODE: 0
PASS
COMMAND: sosreport -a --batch
sosreport (version 1.7)
