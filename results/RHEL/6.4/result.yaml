- ami: ami-014bdc68
  arch: i386
  product: RHEL
  region: us-east-1
  result:
    c1.medium:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''1752580'']'}
        - {command: '[ 1752580 -gt 1700000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''libfprint,coreutils-libs,filesystem,gstreamer-plugins-base,fontconfig,foomatic-db-filesystem,redhat-lsb-compat,jpackage-utils,xml-common,java-1.7.0-openjdk,ghostscript-fonts,mailcap,rh-amazon-rhui-client,hicolor-icon-theme,poppler-data,system-config-network-tui,qt-sqlite,rt73usb-firmware,grub,poppler,xorg-x11-drv-ati-firmware,aic94xx-firmware,fipscheck,ql2400-firmware,bfa-firmware,cvs,ipw2100-firmware,iwl100-firmware,ConsoleKit,iwl4965-firmware,perl-core,nss,libgcc,theora-tools,openldap,ncurses-libs,latencytop,curl,zlib,gdb,libuser,dbus-libs,systemtap-runtime,logrotate,nspr,openssh-server,libyaml,libacl,parted,libsss_idmap,bzip2-libs,cpuspeed,liboil,gamin,acpid,pax,libtalloc,hwloc,libXau,sqlite,pinfo,libXrender,libICE,pam_passwdqc,libXtst,tcp_wrappers-libs,irqbalance,libXrandr,findutils,oprofile,giflib,procps,ltrace,libXcomposite,libgcrypt,rsync,ustr,dbus,nfs4-acl-tools,iptables,bzip2,bridge-utils,initscripts,binutils,rfkill,device-mapper-libs,libvorbis,crash-trace-command,device-mapper-event,net-tools,setserial,kbd,e2fsprogs-libs,gpg-pubkey,samba-winbind,libmng,cryptsetup-luks-libs,libgudev1,hal,keyutils,mesa-libGLU,vim-minimal,kernel,acl,wireless-tools,libss,ntpdate,make,cyrus-sasl,pth,crontabs,perl-Pod-Escapes,python-libs,perl-version,python-dateutil,perl-Test-Harness,libproxy,perl-Module-Load,pytz,perl-IO-Compress-Base,python-prettytable,perl-Archive-Extract,libreport-plugin-reportuploader,perl-Object-Accessor,rpm-python,perl-Compress-Raw-Zlib,libxml2-python,perl-Archive-Tar,authconfig,openjpeg-libs,pygobject2,libgfortran,rhnlib,perl-IO-Compress-Bzip2,abrt-addon-ccpp,perl-Parse-CPAN-Meta,abrt-addon-kerneloops,perl-HTML-Parser,python-cheetah,perl-libxml-perl,gettext,libXfont,python-pycurl,elfutils,pycairo,iw,python-paramiko,grubby,python-kerberos,MAKEDEV,rhn-client-tools,device-mapper-persistent-data,rhn-check,upstart,gnutls,time,cups,cdparanoia-libs,foomatic,gzip,setup,cracklib-dicts,tzdata,coreutils,mesa-dri-filesystem,openssl,tzdata-java,module-init-tools,basesystem,hwdata,ncurses-base,xdg-utils,iso-codes,plymouth-scripts,busybox,urw-fonts,kernel-firmware,rhino,dejavu-fonts-common,qt,libX11-common,rpcbind,ql2200-firmware,pciutils,ql23xx-firmware,libsndfile,zd1211-firmware,poppler-utils,libertas-usb8388-firmware,fipscheck-lib,iwl5000-firmware,bind-libs,atmel-firmware,wget,rt61pci-firmware,krb5-workstation,words,polkit,man-pages,at,ql2100-firmware,pam_krb5,ipw2200-firmware,nss-sysinit,nss-softokn-freebl,nss-tools,glibc,libcurl,bash,gnupg2,libcap,rpm-libs,info,man,libstdc++,passwd,libxml2,nss_compat_ossl,chkconfig,libpath_utils,audit-libs,c-ares,nss-util,pixman,gawk,libthai,libjpeg-turbo,libref_array,expat,hesiod,libselinux,libsss_autofs,glib2,sgpio,sed,libevent,db4,libpcap,readline,libxcb,cyrus-sasl-lib,libXext,libuuid,cairo,libSM,libXfixes,xmlrpc-c,libXcursor,libtdb,pango,krb5-libs,libXinerama,btparser,libXt,libogg,qt3,libidn,libXv,libgpg-error,libdhash,libnl,ethtool,libcap-ng,libsemanage,libudev,policycoreutils,libtevent,iproute,pcre,util-linux-ng,cpio,udev,file-libs,libdrm,libtirpc,device-mapper,elfutils-libs,usermode,atk,kpartx,psmisc,rsyslog,libtiff,openssh,sysvinit-tools,samba-winbind-clients,lcms-libs,dmraid-events,file,libldb,libtheora,cyrus-sasl-gssapi,nss-softokn,libipa_hbac,libselinux-utils,jasper-libs,avahi-libs,gmp,e2fsprogs,m4,libfontenc,libedit,slang,gdbm,perl-Module-Pluggable,perl-Pod-Simple,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Package-Constants,perl-Term-UI,perl-File-Fetch,perl-Test-Simple,perl-URI,perl-Module-CoreList,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Compress-Raw-Bzip2,perl-DBI,numactl,libusb1,perl-DBIx-Simple,perl-CPAN,perl-Module-Build,perl-parent,perl-CPANPLUS,perl-HTML-Tagset,perl-libwww-perl,perl-XML-Parser,atlas,perl-Time-Piece,xorg-x11-font-utils,tmpwatch,gstreamer-tools,hal-libs,libxslt,tcp_wrappers,eggdbus,db4-utils,libutempter,patch,pinentry,libnih,hunspell,libgomp,libhugetlbfs,vim-common,ncurses,less,python-matplotlib,fprintd,libvisual,phonon-backend-gstreamer,redhat-lsb-graphics,redhat-lsb,pulseaudio-libs,SDL,cloud-init,yum-plugin-security,cas,abrt-cli,iotop,dstat,selinux-policy-targeted,iwl1000-firmware,b43-openfwwf,iwl6050-firmware,iwl5150-firmware,man-pages-overrides,hunspell-en,perl-XML-Grove,perl-XML-Dumper,seekwatcher,fprintd-pam,subscription-manager,vim-enhanced,sysstat,pcmciautils,lvm2,cifs-utils,openssh-clients,setuptool,biosdevname,quota,microcode_ctl,dhclient,smartmontools,ledmon,tcpdump,sudo,usbutils,perl-Crypt-SSLeay,audit,psacct,valgrind,crash-gcore-command,mlocate,cyrus-sasl-plain,latencytop-tui,unzip,nano,attr,scl-utils,mtr,traceroute,trace-cmd,rdate,strace,b43-fwcutter,eject,vconfig,gpg-pubkey,lvm2-libs,cryptsetup-luks,pm-utils,mesa-dri1-drivers,mesa-libGL,plymouth,dracut-kernel,autofs,crda,yp-tools,certmonger,ntp,oddjob-mkhomedir,postfix,cronie,virt-what,libffi,python,python-setuptools,python-pygments,libproxy-bin,libproxy-python,system-config-firewall-base,python-nss,python-netaddr,python-boto,libreport-python,libreport,libreport-compat,abrt-libs,newt-python,dbus-python,python-dmidecode,pyOpenSSL,python-simplejson,nfs-utils-lib,libselinux-python,sos,python-rhsm,abrt-addon-python,libreport-plugin-kerneloops,libreport-plugin-logger,libreport-plugin-mailx,numpy,libipa_hbac-python,redhat-lsb-core,blktrace,python-urlgrabber,audit-libs-python,python-iwlib,python-crypto,python-krbV,pytalloc,ipa-python,yum,rhnsd,yum-rhn-plugin,setools-libs-python,libtasn1,cups-libs,gtk2,ghostscript,foomatic-db,redhat-lsb-printing,cracklib,ca-certificates,sssd,pam,latencytop-common,qt-x11,alsa-lib,dhcp-common,libasyncns,redhat-logos,redhat-release-server,ipa-client,jline,fontpackages-filesystem,yum-utils,libssh2,kbd-misc,system-config-firewall-tui,libpciaccess,ql2500-firmware,perf,mysql-libs,rootfiles,iwl6000-firmware,bind-utils,redhat-indexhtml,iwl6000g2a-firmware,ConsoleKit-libs,iwl3945-firmware,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,sssd-client,ivtv-firmware,perl-XML-Twig,mailx,glibc-common,java-1.6.0-openjdk,xmlrpc-c-client,libattr,libhugetlbfs-utils,rpm,libcom_err,kexec-tools,gpgme,popt,samba-client,libaio,freetype,numad,plymouth-core-libs,libpng,readahead,libini_config,libsepol,rng-tools,hdparm,shadow-utils,prelink,gpm-libs,elfutils-libelf,elinks,libX11,dbus-glib,alsa-utils,libXi,libblkid,tcsh,libXft,keyutils-libs,ntsysv,libXdamage,xz-libs,efibootmgr,libXxf86vm,which,lsof,sg3_utils-libs,pciutils-libs,libitm,mingetty,libgssglue,powertop,iputils,grep,zip,selinux-policy,pkgconfig,libtopology,device-mapper-event-libs,lua,latrace,libcgroup,tar,dosfstools,samba-common,dmidecode,dmraid,crash,hal-info,xz,mesa-dri-drivers,bc,dracut,checkpolicy,mdadm,libusb,ypbind,diffutils,oddjob,libtar,cronie-anacron,newt,iptables-ipv6,perl-libs,python-iniparse,perl-Locale-Maketext-Simple,python-nose,perl-devel,python-configobj,perl-IPC-Cmd,python-markdown,perl-Log-Message-Simple,python-argparse,perl-ExtUtils-CBuilder,libreport-plugin-rhtsupport,perl-Module-Loaded,abrt,perl-Compress-Zlib,python-ethtool,perl-Digest-SHA,m2crypto,libcollection,nfs-utils,perl-DBD-SQLite,python-gudev,perl-ExtUtils-Embed,abrt-tui,perl-CGI,libreport-cli,dejavu-sans-fonts,PyYAML,perl-Time-HiRes,python-ldap,xz-lzma-compat,pygpgme,gstreamer,libsemanage-python,flac,python-lxml,setools-libs,yum-metadata-parser,desktop-file-utils,rhn-setup,portreserve,policycoreutils-python,ed,samba4-libs,dash,foomatic-db-ppds,groff'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-d6f384a6",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-014bdc68",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "c1.medium",\r\n  "architecture"
            : "i386",\r\n  "kernelId" : "aki-36ed075f",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:32Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.39",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-014bdc68" = "ami-014bdc68" ]', result: passed}
        - {command: '[ "i386" = "i386" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file:
        - {command: 'parted -l | grep linux-swap | awk ''{print $4}'' | awk -F''MB''
            ''{print $1}''', result: passed, value: '940'}
        - {command: 'parted -l | grep -B 6 swap | grep ''^Disk /'' | awk ''{print
            $2}'' | sed ''$s/.$//'' | head -1', result: passed, value: /dev/xvde3}
        - {command: '[ 940 -gt 0 ]', result: passed}
        - {command: swapoff /dev/xvde3 ; echo, result: passed}
        - {command: swapon /dev/xvde3, result: passed}
        - {command: swapoff /dev/xvde3 && swapon /dev/xvde3, result: passed}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \ti386\r\nStatus:               \tNot Subscribed\r\nStarts:     \
            \          \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-39 ~]# ",
          command: subscription-manager list, expectation: No installed products to
            list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '2',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 37% [=====-         ]  0.0 B/s | 5.2 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 82% [============   ]  11 MB/s |  12 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 39% [=====-         ]  0.0 B/s | 5.5 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 78% [===========-   ] 9.2 MB/s |  11 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''1752580'']'}
        - {command: '[ 1752580 -gt 1700000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.i686}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.i686}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.i686 = 2.6.32-358.el6.i686 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m1.small:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''1711736'']'}
        - {command: '[ 1711736 -gt 1700000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''libfprint,coreutils-libs,filesystem,gstreamer-plugins-base,fontconfig,foomatic-db-filesystem,redhat-lsb-compat,jpackage-utils,xml-common,java-1.7.0-openjdk,ghostscript-fonts,mailcap,rh-amazon-rhui-client,hicolor-icon-theme,poppler-data,system-config-network-tui,qt-sqlite,rt73usb-firmware,grub,poppler,xorg-x11-drv-ati-firmware,aic94xx-firmware,fipscheck,ql2400-firmware,bfa-firmware,cvs,ipw2100-firmware,iwl100-firmware,ConsoleKit,iwl4965-firmware,perl-core,nss,libgcc,theora-tools,openldap,ncurses-libs,latencytop,curl,zlib,gdb,libuser,dbus-libs,systemtap-runtime,logrotate,nspr,openssh-server,libyaml,libacl,parted,libsss_idmap,bzip2-libs,cpuspeed,liboil,gamin,acpid,pax,libtalloc,hwloc,libXau,sqlite,pinfo,libXrender,libICE,pam_passwdqc,libXtst,tcp_wrappers-libs,irqbalance,libXrandr,findutils,oprofile,giflib,procps,ltrace,libXcomposite,libgcrypt,rsync,ustr,dbus,nfs4-acl-tools,iptables,bzip2,bridge-utils,initscripts,binutils,rfkill,device-mapper-libs,libvorbis,crash-trace-command,device-mapper-event,net-tools,setserial,kbd,e2fsprogs-libs,gpg-pubkey,samba-winbind,libmng,cryptsetup-luks-libs,libgudev1,hal,keyutils,mesa-libGLU,vim-minimal,kernel,acl,wireless-tools,libss,ntpdate,make,cyrus-sasl,pth,crontabs,perl-Pod-Escapes,python-libs,perl-version,python-dateutil,perl-Test-Harness,libproxy,perl-Module-Load,pytz,perl-IO-Compress-Base,python-prettytable,perl-Archive-Extract,libreport-plugin-reportuploader,perl-Object-Accessor,rpm-python,perl-Compress-Raw-Zlib,libxml2-python,perl-Archive-Tar,authconfig,openjpeg-libs,pygobject2,libgfortran,rhnlib,perl-IO-Compress-Bzip2,abrt-addon-ccpp,perl-Parse-CPAN-Meta,abrt-addon-kerneloops,perl-HTML-Parser,python-cheetah,perl-libxml-perl,gettext,libXfont,python-pycurl,elfutils,pycairo,iw,python-paramiko,grubby,python-kerberos,MAKEDEV,rhn-client-tools,device-mapper-persistent-data,rhn-check,upstart,gnutls,time,cups,cdparanoia-libs,foomatic,gzip,setup,cracklib-dicts,tzdata,coreutils,mesa-dri-filesystem,openssl,tzdata-java,module-init-tools,basesystem,hwdata,ncurses-base,xdg-utils,iso-codes,plymouth-scripts,busybox,urw-fonts,kernel-firmware,rhino,dejavu-fonts-common,qt,libX11-common,rpcbind,ql2200-firmware,pciutils,ql23xx-firmware,libsndfile,zd1211-firmware,poppler-utils,libertas-usb8388-firmware,fipscheck-lib,iwl5000-firmware,bind-libs,atmel-firmware,wget,rt61pci-firmware,krb5-workstation,words,polkit,man-pages,at,ql2100-firmware,pam_krb5,ipw2200-firmware,nss-sysinit,nss-softokn-freebl,nss-tools,glibc,libcurl,bash,gnupg2,libcap,rpm-libs,info,man,libstdc++,passwd,libxml2,nss_compat_ossl,chkconfig,libpath_utils,audit-libs,c-ares,nss-util,pixman,gawk,libthai,libjpeg-turbo,libref_array,expat,hesiod,libselinux,libsss_autofs,glib2,sgpio,sed,libevent,db4,libpcap,readline,libxcb,cyrus-sasl-lib,libXext,libuuid,cairo,libSM,libXfixes,xmlrpc-c,libXcursor,libtdb,pango,krb5-libs,libXinerama,btparser,libXt,libogg,qt3,libidn,libXv,libgpg-error,libdhash,libnl,ethtool,libcap-ng,libsemanage,libudev,policycoreutils,libtevent,iproute,pcre,util-linux-ng,cpio,udev,file-libs,libdrm,libtirpc,device-mapper,elfutils-libs,usermode,atk,kpartx,psmisc,rsyslog,libtiff,openssh,sysvinit-tools,samba-winbind-clients,lcms-libs,dmraid-events,file,libldb,libtheora,cyrus-sasl-gssapi,nss-softokn,libipa_hbac,libselinux-utils,jasper-libs,avahi-libs,gmp,e2fsprogs,m4,libfontenc,libedit,slang,gdbm,perl-Module-Pluggable,perl-Pod-Simple,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Package-Constants,perl-Term-UI,perl-File-Fetch,perl-Test-Simple,perl-URI,perl-Module-CoreList,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Compress-Raw-Bzip2,perl-DBI,numactl,libusb1,perl-DBIx-Simple,perl-CPAN,perl-Module-Build,perl-parent,perl-CPANPLUS,perl-HTML-Tagset,perl-libwww-perl,perl-XML-Parser,atlas,perl-Time-Piece,xorg-x11-font-utils,tmpwatch,gstreamer-tools,hal-libs,libxslt,tcp_wrappers,eggdbus,db4-utils,libutempter,patch,pinentry,libnih,hunspell,libgomp,libhugetlbfs,vim-common,ncurses,less,python-matplotlib,fprintd,libvisual,phonon-backend-gstreamer,redhat-lsb-graphics,redhat-lsb,pulseaudio-libs,SDL,cloud-init,yum-plugin-security,cas,abrt-cli,iotop,dstat,selinux-policy-targeted,iwl1000-firmware,b43-openfwwf,iwl6050-firmware,iwl5150-firmware,man-pages-overrides,hunspell-en,perl-XML-Grove,perl-XML-Dumper,seekwatcher,fprintd-pam,subscription-manager,vim-enhanced,sysstat,pcmciautils,lvm2,cifs-utils,openssh-clients,setuptool,biosdevname,quota,microcode_ctl,dhclient,smartmontools,ledmon,tcpdump,sudo,usbutils,perl-Crypt-SSLeay,audit,psacct,valgrind,crash-gcore-command,mlocate,cyrus-sasl-plain,latencytop-tui,unzip,nano,attr,scl-utils,mtr,traceroute,trace-cmd,rdate,strace,b43-fwcutter,eject,vconfig,gpg-pubkey,lvm2-libs,cryptsetup-luks,pm-utils,mesa-dri1-drivers,mesa-libGL,plymouth,dracut-kernel,autofs,crda,yp-tools,certmonger,ntp,oddjob-mkhomedir,postfix,cronie,virt-what,libffi,python,python-setuptools,python-pygments,libproxy-bin,libproxy-python,system-config-firewall-base,python-nss,python-netaddr,python-boto,libreport-python,libreport,libreport-compat,abrt-libs,newt-python,dbus-python,python-dmidecode,pyOpenSSL,python-simplejson,nfs-utils-lib,libselinux-python,sos,python-rhsm,abrt-addon-python,libreport-plugin-kerneloops,libreport-plugin-logger,libreport-plugin-mailx,numpy,libipa_hbac-python,redhat-lsb-core,blktrace,python-urlgrabber,audit-libs-python,python-iwlib,python-crypto,python-krbV,pytalloc,ipa-python,yum,rhnsd,yum-rhn-plugin,setools-libs-python,libtasn1,cups-libs,gtk2,ghostscript,foomatic-db,redhat-lsb-printing,cracklib,ca-certificates,sssd,pam,latencytop-common,qt-x11,alsa-lib,dhcp-common,libasyncns,redhat-logos,redhat-release-server,ipa-client,jline,fontpackages-filesystem,yum-utils,libssh2,kbd-misc,system-config-firewall-tui,libpciaccess,ql2500-firmware,perf,mysql-libs,rootfiles,iwl6000-firmware,bind-utils,redhat-indexhtml,iwl6000g2a-firmware,ConsoleKit-libs,iwl3945-firmware,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,sssd-client,ivtv-firmware,perl-XML-Twig,mailx,glibc-common,java-1.6.0-openjdk,xmlrpc-c-client,libattr,libhugetlbfs-utils,rpm,libcom_err,kexec-tools,gpgme,popt,samba-client,libaio,freetype,numad,plymouth-core-libs,libpng,readahead,libini_config,libsepol,rng-tools,hdparm,shadow-utils,prelink,gpm-libs,elfutils-libelf,elinks,libX11,dbus-glib,alsa-utils,libXi,libblkid,tcsh,libXft,keyutils-libs,ntsysv,libXdamage,xz-libs,efibootmgr,libXxf86vm,which,lsof,sg3_utils-libs,pciutils-libs,libitm,mingetty,libgssglue,powertop,iputils,grep,zip,selinux-policy,pkgconfig,libtopology,device-mapper-event-libs,lua,latrace,libcgroup,tar,dosfstools,samba-common,dmidecode,dmraid,crash,hal-info,xz,mesa-dri-drivers,bc,dracut,checkpolicy,mdadm,libusb,ypbind,diffutils,oddjob,libtar,cronie-anacron,newt,iptables-ipv6,perl-libs,python-iniparse,perl-Locale-Maketext-Simple,python-nose,perl-devel,python-configobj,perl-IPC-Cmd,python-markdown,perl-Log-Message-Simple,python-argparse,perl-ExtUtils-CBuilder,libreport-plugin-rhtsupport,perl-Module-Loaded,abrt,perl-Compress-Zlib,python-ethtool,perl-Digest-SHA,m2crypto,libcollection,nfs-utils,perl-DBD-SQLite,python-gudev,perl-ExtUtils-Embed,abrt-tui,perl-CGI,libreport-cli,dejavu-sans-fonts,PyYAML,perl-Time-HiRes,python-ldap,xz-lzma-compat,pygpgme,gstreamer,libsemanage-python,flac,python-lxml,setools-libs,yum-metadata-parser,desktop-file-utils,rhn-setup,portreserve,policycoreutils-python,ed,samba4-libs,dash,foomatic-db-ppds,groff'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-d8f384a8",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-014bdc68",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m1.small",\r\n  "architecture"
            : "i386",\r\n  "kernelId" : "aki-36ed075f",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:32Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.54",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-014bdc68" = "ami-014bdc68" ]', result: passed}
        - {command: '[ "i386" = "i386" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file:
        - {command: 'parted -l | grep linux-swap | awk ''{print $4}'' | awk -F''MB''
            ''{print $1}''', result: passed, value: '940'}
        - {command: 'parted -l | grep -B 6 swap | grep ''^Disk /'' | awk ''{print
            $2}'' | sed ''$s/.$//'' | head -1', result: passed, value: /dev/xvde3}
        - {command: '[ 940 -gt 0 ]', result: passed}
        - {command: swapoff /dev/xvde3 ; echo, result: passed}
        - {command: swapon /dev/xvde3, result: passed}
        - {command: swapoff /dev/xvde3 && swapon /dev/xvde3, result: passed}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \ti386\r\nStatus:               \tNot Subscribed\r\nStarts:     \
            \          \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-54 ~]# ",
          command: subscription-manager list, expectation: No installed products to
            list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '1',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 20% [===            ]  0.0 B/s | 2.9 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 43% [======         ] 5.3 MB/s | 6.1 MB     00:01 ETA \rrhui-us-east-1-rhel-serve\
            \ 65% [=========-     ] 5.6 MB/s | 9.3 MB     00:00 ETA \rrhui-us-east-1-rhel-serve\
            \ 87% [=============  ] 5.8 MB/s |  12 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:01     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 21% [===            ]  0.0 B/s | 3.1 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 44% [======-        ] 5.2 MB/s | 6.2 MB     00:01 ETA \rrhui-us-east-1-rhel-serve\
            \ 66% [=========-     ] 5.5 MB/s | 9.4 MB     00:00 ETA \rrhui-us-east-1-rhel-serve\
            \ 89% [=============  ] 5.8 MB/s |  13 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:01     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''1711736'']'}
        - {command: '[ 1711736 -gt 1700000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.i686}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.i686}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.i686 = 2.6.32-358.el6.i686 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    t1.micro:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''610224'']'}
        - {command: '[ 610224 -gt 600000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''libfprint,coreutils-libs,filesystem,gstreamer-plugins-base,fontconfig,foomatic-db-filesystem,redhat-lsb-compat,jpackage-utils,xml-common,java-1.7.0-openjdk,ghostscript-fonts,mailcap,rh-amazon-rhui-client,hicolor-icon-theme,poppler-data,system-config-network-tui,qt-sqlite,rt73usb-firmware,grub,poppler,xorg-x11-drv-ati-firmware,aic94xx-firmware,fipscheck,ql2400-firmware,bfa-firmware,cvs,ipw2100-firmware,iwl100-firmware,ConsoleKit,iwl4965-firmware,perl-core,nss,libgcc,theora-tools,openldap,ncurses-libs,latencytop,curl,zlib,gdb,libuser,dbus-libs,systemtap-runtime,logrotate,nspr,openssh-server,libyaml,libacl,parted,libsss_idmap,bzip2-libs,cpuspeed,liboil,gamin,acpid,pax,libtalloc,hwloc,libXau,sqlite,pinfo,libXrender,libICE,pam_passwdqc,libXtst,tcp_wrappers-libs,irqbalance,libXrandr,findutils,oprofile,giflib,procps,ltrace,libXcomposite,libgcrypt,rsync,ustr,dbus,nfs4-acl-tools,iptables,bzip2,bridge-utils,initscripts,binutils,rfkill,device-mapper-libs,libvorbis,crash-trace-command,device-mapper-event,net-tools,setserial,kbd,e2fsprogs-libs,gpg-pubkey,samba-winbind,libmng,cryptsetup-luks-libs,libgudev1,hal,keyutils,mesa-libGLU,vim-minimal,kernel,acl,wireless-tools,libss,ntpdate,make,cyrus-sasl,pth,crontabs,perl-Pod-Escapes,python-libs,perl-version,python-dateutil,perl-Test-Harness,libproxy,perl-Module-Load,pytz,perl-IO-Compress-Base,python-prettytable,perl-Archive-Extract,libreport-plugin-reportuploader,perl-Object-Accessor,rpm-python,perl-Compress-Raw-Zlib,libxml2-python,perl-Archive-Tar,authconfig,openjpeg-libs,pygobject2,libgfortran,rhnlib,perl-IO-Compress-Bzip2,abrt-addon-ccpp,perl-Parse-CPAN-Meta,abrt-addon-kerneloops,perl-HTML-Parser,python-cheetah,perl-libxml-perl,gettext,libXfont,python-pycurl,elfutils,pycairo,iw,python-paramiko,grubby,python-kerberos,MAKEDEV,rhn-client-tools,device-mapper-persistent-data,rhn-check,upstart,gnutls,time,cups,cdparanoia-libs,foomatic,gzip,setup,cracklib-dicts,tzdata,coreutils,mesa-dri-filesystem,openssl,tzdata-java,module-init-tools,basesystem,hwdata,ncurses-base,xdg-utils,iso-codes,plymouth-scripts,busybox,urw-fonts,kernel-firmware,rhino,dejavu-fonts-common,qt,libX11-common,rpcbind,ql2200-firmware,pciutils,ql23xx-firmware,libsndfile,zd1211-firmware,poppler-utils,libertas-usb8388-firmware,fipscheck-lib,iwl5000-firmware,bind-libs,atmel-firmware,wget,rt61pci-firmware,krb5-workstation,words,polkit,man-pages,at,ql2100-firmware,pam_krb5,ipw2200-firmware,nss-sysinit,nss-softokn-freebl,nss-tools,glibc,libcurl,bash,gnupg2,libcap,rpm-libs,info,man,libstdc++,passwd,libxml2,nss_compat_ossl,chkconfig,libpath_utils,audit-libs,c-ares,nss-util,pixman,gawk,libthai,libjpeg-turbo,libref_array,expat,hesiod,libselinux,libsss_autofs,glib2,sgpio,sed,libevent,db4,libpcap,readline,libxcb,cyrus-sasl-lib,libXext,libuuid,cairo,libSM,libXfixes,xmlrpc-c,libXcursor,libtdb,pango,krb5-libs,libXinerama,btparser,libXt,libogg,qt3,libidn,libXv,libgpg-error,libdhash,libnl,ethtool,libcap-ng,libsemanage,libudev,policycoreutils,libtevent,iproute,pcre,util-linux-ng,cpio,udev,file-libs,libdrm,libtirpc,device-mapper,elfutils-libs,usermode,atk,kpartx,psmisc,rsyslog,libtiff,openssh,sysvinit-tools,samba-winbind-clients,lcms-libs,dmraid-events,file,libldb,libtheora,cyrus-sasl-gssapi,nss-softokn,libipa_hbac,libselinux-utils,jasper-libs,avahi-libs,gmp,e2fsprogs,m4,libfontenc,libedit,slang,gdbm,perl-Module-Pluggable,perl-Pod-Simple,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Package-Constants,perl-Term-UI,perl-File-Fetch,perl-Test-Simple,perl-URI,perl-Module-CoreList,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Compress-Raw-Bzip2,perl-DBI,numactl,libusb1,perl-DBIx-Simple,perl-CPAN,perl-Module-Build,perl-parent,perl-CPANPLUS,perl-HTML-Tagset,perl-libwww-perl,perl-XML-Parser,atlas,perl-Time-Piece,xorg-x11-font-utils,tmpwatch,gstreamer-tools,hal-libs,libxslt,tcp_wrappers,eggdbus,db4-utils,libutempter,patch,pinentry,libnih,hunspell,libgomp,libhugetlbfs,vim-common,ncurses,less,python-matplotlib,fprintd,libvisual,phonon-backend-gstreamer,redhat-lsb-graphics,redhat-lsb,pulseaudio-libs,SDL,cloud-init,yum-plugin-security,cas,abrt-cli,iotop,dstat,selinux-policy-targeted,iwl1000-firmware,b43-openfwwf,iwl6050-firmware,iwl5150-firmware,man-pages-overrides,hunspell-en,perl-XML-Grove,perl-XML-Dumper,seekwatcher,fprintd-pam,subscription-manager,vim-enhanced,sysstat,pcmciautils,lvm2,cifs-utils,openssh-clients,setuptool,biosdevname,quota,microcode_ctl,dhclient,smartmontools,ledmon,tcpdump,sudo,usbutils,perl-Crypt-SSLeay,audit,psacct,valgrind,crash-gcore-command,mlocate,cyrus-sasl-plain,latencytop-tui,unzip,nano,attr,scl-utils,mtr,traceroute,trace-cmd,rdate,strace,b43-fwcutter,eject,vconfig,gpg-pubkey,lvm2-libs,cryptsetup-luks,pm-utils,mesa-dri1-drivers,mesa-libGL,plymouth,dracut-kernel,autofs,crda,yp-tools,certmonger,ntp,oddjob-mkhomedir,postfix,cronie,virt-what,libffi,python,python-setuptools,python-pygments,libproxy-bin,libproxy-python,system-config-firewall-base,python-nss,python-netaddr,python-boto,libreport-python,libreport,libreport-compat,abrt-libs,newt-python,dbus-python,python-dmidecode,pyOpenSSL,python-simplejson,nfs-utils-lib,libselinux-python,sos,python-rhsm,abrt-addon-python,libreport-plugin-kerneloops,libreport-plugin-logger,libreport-plugin-mailx,numpy,libipa_hbac-python,redhat-lsb-core,blktrace,python-urlgrabber,audit-libs-python,python-iwlib,python-crypto,python-krbV,pytalloc,ipa-python,yum,rhnsd,yum-rhn-plugin,setools-libs-python,libtasn1,cups-libs,gtk2,ghostscript,foomatic-db,redhat-lsb-printing,cracklib,ca-certificates,sssd,pam,latencytop-common,qt-x11,alsa-lib,dhcp-common,libasyncns,redhat-logos,redhat-release-server,ipa-client,jline,fontpackages-filesystem,yum-utils,libssh2,kbd-misc,system-config-firewall-tui,libpciaccess,ql2500-firmware,perf,mysql-libs,rootfiles,iwl6000-firmware,bind-utils,redhat-indexhtml,iwl6000g2a-firmware,ConsoleKit-libs,iwl3945-firmware,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,sssd-client,ivtv-firmware,perl-XML-Twig,mailx,glibc-common,java-1.6.0-openjdk,xmlrpc-c-client,libattr,libhugetlbfs-utils,rpm,libcom_err,kexec-tools,gpgme,popt,samba-client,libaio,freetype,numad,plymouth-core-libs,libpng,readahead,libini_config,libsepol,rng-tools,hdparm,shadow-utils,prelink,gpm-libs,elfutils-libelf,elinks,libX11,dbus-glib,alsa-utils,libXi,libblkid,tcsh,libXft,keyutils-libs,ntsysv,libXdamage,xz-libs,efibootmgr,libXxf86vm,which,lsof,sg3_utils-libs,pciutils-libs,libitm,mingetty,libgssglue,powertop,iputils,grep,zip,selinux-policy,pkgconfig,libtopology,device-mapper-event-libs,lua,latrace,libcgroup,tar,dosfstools,samba-common,dmidecode,dmraid,crash,hal-info,xz,mesa-dri-drivers,bc,dracut,checkpolicy,mdadm,libusb,ypbind,diffutils,oddjob,libtar,cronie-anacron,newt,iptables-ipv6,perl-libs,python-iniparse,perl-Locale-Maketext-Simple,python-nose,perl-devel,python-configobj,perl-IPC-Cmd,python-markdown,perl-Log-Message-Simple,python-argparse,perl-ExtUtils-CBuilder,libreport-plugin-rhtsupport,perl-Module-Loaded,abrt,perl-Compress-Zlib,python-ethtool,perl-Digest-SHA,m2crypto,libcollection,nfs-utils,perl-DBD-SQLite,python-gudev,perl-ExtUtils-Embed,abrt-tui,perl-CGI,libreport-cli,dejavu-sans-fonts,PyYAML,perl-Time-HiRes,python-ldap,xz-lzma-compat,pygpgme,gstreamer,libsemanage-python,flac,python-lxml,setools-libs,yum-metadata-parser,desktop-file-utils,rhn-setup,portreserve,policycoreutils-python,ed,samba4-libs,dash,foomatic-db-ppds,groff'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-10f38460",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-014bdc68",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "t1.micro",\r\n  "architecture"
            : "i386",\r\n  "kernelId" : "aki-36ed075f",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:24Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.14",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-014bdc68" = "ami-014bdc68" ]', result: passed}
        - {command: '[ "i386" = "i386" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for ec2name = t1.micro, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \ti386\r\nStatus:               \tNot Subscribed\r\nStarts:     \
            \          \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-14 ~]# ",
          command: subscription-manager list, expectation: No installed products to
            list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '1',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: head -c $((1024*1024*1024)) /dev/zero > /swap && echo SUCCESS,
          expectation: "\r\nSUCCESS\r\n", result: passed}
        - {command: mkswap /swap, result: passed}
        - {command: echo '/swap    swap     swap    defaults     0 0' >> /etc/fstab
            && echo SUCCESS, expectation: "\r\nSUCCESS\r\n", result: passed}
        - {actual: '255', command: swapon -a, result: failed}
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 32% [====-          ]  0.0 B/s | 4.6 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 75% [===========    ]  10 MB/s |  11 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 33% [====-          ]  0.0 B/s | 4.7 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 74% [===========    ] 9.7 MB/s |  11 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {actual: None, command: service iptables restart, result: failed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''610224'']'}
        - {command: '[ 610224 -gt 600000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.i686}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.i686}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.i686 = 2.6.32-358.el6.i686 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-834fd8ea
  arch: x86_64
  product: RHEL
  region: us-east-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-5cf4832c",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-834fd8ea",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "cc2.8xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:12:57Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.52",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-834fd8ea" = "ami-834fd8ea" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-52\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '32',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 59% [========-      ]  0.0 B/s | 8.2 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 53% [========       ]  0.0 B/s | 7.4 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cg1.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''23146704'']'}
        - {command: '[ 23146704 -gt 22000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-fef4838e",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-834fd8ea",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "cg1.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:03Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.33",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-834fd8ea" = "ami-834fd8ea" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-33\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '16',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 37% [=====-         ]  0.0 B/s | 5.2 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 91% [=============- ]  12 MB/s |  13 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 47% [=======        ]  0.0 B/s | 6.5 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 97% [==============-]  11 MB/s |  13 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''23146704'']'}
        - {command: '[ 23146704 -gt 22000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cr1.8xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''252398824'']'}
        - {command: '[ 252398824 -gt 244000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-b2f483c2",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-834fd8ea",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "cr1.8xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:08Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.61",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-834fd8ea" = "ami-834fd8ea" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-61\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '32',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 45% [======-        ]  0.0 B/s | 6.3 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 64% [=========-     ]  0.0 B/s | 8.9 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''252398824'']'}
        - {command: '[ 252398824 -gt 244000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    hi1.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62535708'']'}
        - {command: '[ 62535708 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-e8f48398",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-834fd8ea",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "hi1.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:03Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.5",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-834fd8ea" = "ami-834fd8ea" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-5\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {actual: "cat /proc/cpuinfo | grep '^processor' | wc -l\r\n16\r\n[root@ip-10-3-94-5\
            \ ~]# ", command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: failed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 59% [========-      ]  0.0 B/s | 8.2 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 63% [=========      ]  0.0 B/s | 8.7 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62535708'']'}
        - {command: '[ 62535708 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-96f582e6",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-834fd8ea",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:12:39Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.49",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-834fd8ea" = "ami-834fd8ea" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-49\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 54% [========       ]  0.0 B/s | 7.5 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 56% [========       ]  0.0 B/s | 7.7 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-08f58278",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-834fd8ea",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:12:28Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.6",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-834fd8ea" = "ami-834fd8ea" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-6\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 54% [========       ]  0.0 B/s | 7.5 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 46% [=======        ]  0.0 B/s | 6.4 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 87% [=============  ] 9.3 MB/s |  12 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-db4bdcb2
  arch: x86_64
  product: RHEL
  region: us-east-1
  result:
    c1.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''7130200'']'}
        - {command: '[ 7130200 -gt 7000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-2af0875a",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-db4bdcb2",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "c1.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-08ed0761",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:14:30Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.20",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-db4bdcb2" = "ami-db4bdcb2" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-20\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 54% [========       ]  0.0 B/s | 7.5 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 63% [=========-     ]  0.0 B/s | 8.7 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''7130200'']'}
        - {command: '[ 7130200 -gt 7000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m1.large:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''7645996'']'}
        - {command: '[ 7645996 -gt 7500000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-2cf1865c",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-db4bdcb2",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m1.large",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-08ed0761",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:14:12Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.30",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-db4bdcb2" = "ami-db4bdcb2" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-30\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '2',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 59% [========-      ]  0.0 B/s | 8.1 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 60% [=========      ]  0.0 B/s | 8.3 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''7645996'']'}
        - {command: '[ 7645996 -gt 7500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m1.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15371588'']'}
        - {command: '[ 15371588 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-a6f186d6",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-db4bdcb2",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m1.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-08ed0761",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:14:15Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.56",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-db4bdcb2" = "ami-db4bdcb2" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-56\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 40% [======         ]  0.0 B/s | 5.5 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 39% [=====-         ]  0.0 B/s | 5.5 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15371588'']'}
        - {command: '[ 15371588 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m2.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''35127780'']'}
        - {command: '[ 35127780 -gt 34200000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-5ef0872e",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-db4bdcb2",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m2.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-08ed0761",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:14:21Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.15",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-db4bdcb2" = "ami-db4bdcb2" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-15\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 59% [========-      ]  0.0 B/s | 8.2 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 54% [========       ]  0.0 B/s | 7.4 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''35127780'']'}
        - {command: '[ 35127780 -gt 34200000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m2.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''70336952'']'}
        - {command: '[ 70336952 -gt 68400000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-3af0874a",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-db4bdcb2",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m2.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-08ed0761",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:14:26Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.23",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-db4bdcb2" = "ami-db4bdcb2" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-23\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 53% [========       ]  0.0 B/s | 7.4 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 45% [======-        ]  0.0 B/s | 6.3 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''70336952'']'}
        - {command: '[ 70336952 -gt 68400000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m2.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''17524092'']'}
        - {command: '[ 17524092 -gt 17100000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-9cf186ec",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-db4bdcb2",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m2.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-08ed0761",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:14:17Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.10",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-db4bdcb2" = "ami-db4bdcb2" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-10\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '2',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 59% [========-      ]  0.0 B/s | 8.2 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 48% [=======        ]  0.0 B/s | 6.6 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 96% [============== ]  11 MB/s |  13 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''17524092'']'}
        - {command: '[ 17524092 -gt 17100000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    t1.micro:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''604680'']'}
        - {command: '[ 604680 -gt 600000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-50f18620",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-db4bdcb2",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "t1.micro",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-08ed0761",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:14:06Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.37",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-db4bdcb2" = "ami-db4bdcb2" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-37\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '1',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: head -c $((1024*1024*1024)) /dev/zero > /swap && echo SUCCESS,
          expectation: "\r\nSUCCESS\r\n", result: passed}
        - {command: mkswap /swap, result: passed}
        - {command: echo '/swap    swap     swap    defaults     0 0' >> /etc/fstab
            && echo SUCCESS, expectation: "\r\nSUCCESS\r\n", result: passed}
        - {command: swapon -a, result: passed}
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 30% [====-          ]  0.0 B/s | 4.2 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 72% [==========-    ] 9.5 MB/s | 9.9 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 38% [=====-         ]  0.0 B/s | 5.3 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 94% [============== ]  13 MB/s |  13 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''604680'']'}
        - {command: '[ 604680 -gt 600000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-d94bdcb0
  arch: x86_64
  product: RHEL
  region: us-east-1
  result:
    c1.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''7130200'']'}
        - {command: '[ 7130200 -gt 7000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-a8f285d8",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-d94bdcb0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "c1.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-ecfa0185",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:14:01Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.36",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-d94bdcb0" = "ami-d94bdcb0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-36\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 56% [========       ]  0.0 B/s | 7.8 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 53% [========       ]  0.0 B/s | 7.3 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''7130200'']'}
        - {command: '[ 7130200 -gt 7000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m1.large:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''7645996'']'}
        - {command: '[ 7645996 -gt 7500000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-64f28514",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-d94bdcb0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m1.large",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-ecfa0185",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:43Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.26",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-d94bdcb0" = "ami-d94bdcb0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-26\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '2',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 63% [=========-     ]  0.0 B/s | 8.8 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 64% [=========-     ]  0.0 B/s | 8.8 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''7645996'']'}
        - {command: '[ 7645996 -gt 7500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m1.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15371588'']'}
        - {command: '[ 15371588 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-42f28532",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-d94bdcb0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m1.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-ecfa0185",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:47Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.41",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-d94bdcb0" = "ami-d94bdcb0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-41\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 56% [========-      ]  0.0 B/s | 7.8 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 50% [=======-       ]  0.0 B/s | 6.9 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15371588'']'}
        - {command: '[ 15371588 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m2.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''35127780'']'}
        - {command: '[ 35127780 -gt 34200000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-32f28542",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-d94bdcb0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m2.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-ecfa0185",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:48Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.42",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-d94bdcb0" = "ami-d94bdcb0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-42\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 56% [========-      ]  0.0 B/s | 7.8 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 57% [========-      ]  0.0 B/s | 7.9 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''35127780'']'}
        - {command: '[ 35127780 -gt 34200000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m2.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''70336952'']'}
        - {command: '[ 70336952 -gt 68400000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-14f28564",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-d94bdcb0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m2.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-ecfa0185",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:50Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.7",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-d94bdcb0" = "ami-d94bdcb0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-7\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 41% [======         ]  0.0 B/s | 5.7 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 85% [============-  ]  10 MB/s |  12 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 62% [=========      ]  0.0 B/s | 8.5 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''70336952'']'}
        - {command: '[ 70336952 -gt 68400000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m2.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''17524092'']'}
        - {command: '[ 17524092 -gt 17100000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-38f28548",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-d94bdcb0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m2.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-ecfa0185",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:48Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.45",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-d94bdcb0" = "ami-d94bdcb0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {actual: '', command: setenforce Permissive && getenforce, expectation: "\r\n\
            Permissive\r\n", result: failed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {actual: None, command: '[ ext4 = ext4 ]', result: failed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-45\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '2',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 58% [========-      ]  0.0 B/s | 8.0 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 65% [=========-     ]  0.0 B/s | 9.0 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''17524092'']'}
        - {command: '[ 17524092 -gt 17100000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    t1.micro:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''604680'']'}
        - {command: '[ 604680 -gt 600000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-62f28512",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-d94bdcb0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "t1.micro",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : "aki-ecfa0185",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:42Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.40",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-d94bdcb0" = "ami-d94bdcb0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-40\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '1',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: head -c $((1024*1024*1024)) /dev/zero > /swap && echo SUCCESS,
          expectation: "\r\nSUCCESS\r\n", result: passed}
        - {command: mkswap /swap, result: passed}
        - {command: echo '/swap    swap     swap    defaults     0 0' >> /etc/fstab
            && echo SUCCESS, expectation: "\r\nSUCCESS\r\n", result: passed}
        - {command: swapon -a, result: passed}
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 42% [======         ]  0.0 B/s | 5.8 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 86% [============-  ]  10 MB/s |  12 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 48% [=======        ]  0.0 B/s | 6.6 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 91% [=============- ] 9.9 MB/s |  13 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''604680'']'}
        - {command: '[ 604680 -gt 600000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-994fd8f0
  arch: x86_64
  product: RHEL
  region: us-east-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-00f58270",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-994fd8f0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "cc2.8xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:12:28Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.4",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-994fd8f0" = "ami-994fd8f0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-4\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '32',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 58% [========-      ]  0.0 B/s | 8.1 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 61% [=========      ]  0.0 B/s | 8.5 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cg1.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''23146704'']'}
        - {command: '[ 23146704 -gt 22000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-0af5827a",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-994fd8f0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "cg1.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:12:28Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.29",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-994fd8f0" = "ami-994fd8f0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-29\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '16',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 57% [========-      ]  0.0 B/s | 7.9 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 56% [========       ]  0.0 B/s | 7.7 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''23146704'']'}
        - {command: '[ 23146704 -gt 22000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cr1.8xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''252398824'']'}
        - {command: '[ 252398824 -gt 244000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-06f58276",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-994fd8f0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "cr1.8xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:12:28Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.11",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-994fd8f0" = "ami-994fd8f0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-11\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '32',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 18% [==-            ]  0.0 B/s | 2.5 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 42% [======         ] 5.6 MB/s | 5.8 MB     00:01 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 51% [=======-       ]  0.0 B/s | 7.0 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''252398824'']'}
        - {command: '[ 252398824 -gt 244000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    hi1.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62535708'']'}
        - {command: '[ 62535708 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-02f58272",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-994fd8f0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "hi1.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:12:28Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.16",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-994fd8f0" = "ami-994fd8f0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-16\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {actual: "cat /proc/cpuinfo | grep '^processor' | wc -l\r\n16\r\n[root@ip-10-3-94-16\
            \ ~]# ", command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: failed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 58% [========-      ]  0.0 B/s | 8.0 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 57% [========-      ]  0.0 B/s | 7.9 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62535708'']'}
        - {command: '[ 62535708 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-04f58274",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-994fd8f0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:12:28Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.47",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-994fd8f0" = "ami-994fd8f0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-47\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 50% [=======-       ]  0.0 B/s | 6.9 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 58% [========-      ]  0.0 B/s | 8.1 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-1ef5826e",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-994fd8f0",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:12:28Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.19",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-994fd8f0" = "ami-994fd8f0" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \tx86_64\r\nStatus:               \tNot Subscribed\r\nStarts:   \
            \            \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-19\
            \ ~]# ", command: subscription-manager list, expectation: No installed
            products to list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 54% [========       ]  0.0 B/s | 7.4 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 57% [========-      ]  0.0 B/s | 7.9 MB     --:-- ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 2.1 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 8,173\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 5,075\r\nrepolist: 13,249"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-0d4bdc64
  arch: i386
  product: RHEL
  region: us-east-1
  result:
    c1.medium:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''1752580'']'}
        - {command: '[ 1752580 -gt 1700000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''libfprint,coreutils-libs,filesystem,gstreamer-plugins-base,fontconfig,foomatic-db-filesystem,redhat-lsb-compat,jpackage-utils,xml-common,java-1.7.0-openjdk,ghostscript-fonts,mailcap,rh-amazon-rhui-client,hicolor-icon-theme,poppler-data,system-config-network-tui,qt-sqlite,rt73usb-firmware,grub,poppler,xorg-x11-drv-ati-firmware,aic94xx-firmware,fipscheck,ql2400-firmware,bfa-firmware,cvs,ipw2100-firmware,iwl100-firmware,ConsoleKit,iwl4965-firmware,perl-core,nss,libgcc,theora-tools,openldap,ncurses-libs,latencytop,curl,zlib,gdb,libuser,dbus-libs,systemtap-runtime,logrotate,nspr,openssh-server,libyaml,libacl,parted,libsss_idmap,bzip2-libs,cpuspeed,liboil,gamin,acpid,pax,libtalloc,hwloc,libXau,sqlite,pinfo,libXrender,libICE,pam_passwdqc,libXtst,tcp_wrappers-libs,irqbalance,libXrandr,findutils,oprofile,giflib,procps,ltrace,libXcomposite,libgcrypt,rsync,ustr,dbus,nfs4-acl-tools,iptables,bzip2,bridge-utils,initscripts,binutils,rfkill,device-mapper-libs,libvorbis,crash-trace-command,device-mapper-event,net-tools,setserial,kbd,e2fsprogs-libs,gpg-pubkey,samba-winbind,libmng,cryptsetup-luks-libs,libgudev1,hal,keyutils,mesa-libGLU,vim-minimal,kernel,acl,wireless-tools,libss,ntpdate,make,cyrus-sasl,pth,crontabs,perl-Pod-Escapes,python-libs,perl-version,python-dateutil,perl-Test-Harness,libproxy,perl-Module-Load,pytz,perl-IO-Compress-Base,python-prettytable,perl-Archive-Extract,libreport-plugin-reportuploader,perl-Object-Accessor,rpm-python,perl-Compress-Raw-Zlib,libxml2-python,perl-Archive-Tar,authconfig,openjpeg-libs,pygobject2,libgfortran,rhnlib,perl-IO-Compress-Bzip2,abrt-addon-ccpp,perl-Parse-CPAN-Meta,abrt-addon-kerneloops,perl-HTML-Parser,python-cheetah,perl-libxml-perl,gettext,libXfont,python-pycurl,elfutils,pycairo,iw,python-paramiko,grubby,python-kerberos,MAKEDEV,rhn-client-tools,device-mapper-persistent-data,rhn-check,upstart,gnutls,time,cups,cdparanoia-libs,foomatic,gzip,setup,cracklib-dicts,tzdata,coreutils,mesa-dri-filesystem,openssl,tzdata-java,module-init-tools,basesystem,hwdata,ncurses-base,xdg-utils,iso-codes,plymouth-scripts,busybox,urw-fonts,kernel-firmware,rhino,dejavu-fonts-common,qt,libX11-common,rpcbind,ql2200-firmware,pciutils,ql23xx-firmware,libsndfile,zd1211-firmware,poppler-utils,libertas-usb8388-firmware,fipscheck-lib,iwl5000-firmware,bind-libs,atmel-firmware,wget,rt61pci-firmware,krb5-workstation,words,polkit,man-pages,at,ql2100-firmware,pam_krb5,ipw2200-firmware,nss-sysinit,nss-softokn-freebl,nss-tools,glibc,libcurl,bash,gnupg2,libcap,rpm-libs,info,man,libstdc++,passwd,libxml2,nss_compat_ossl,chkconfig,libpath_utils,audit-libs,c-ares,nss-util,pixman,gawk,libthai,libjpeg-turbo,libref_array,expat,hesiod,libselinux,libsss_autofs,glib2,sgpio,sed,libevent,db4,libpcap,readline,libxcb,cyrus-sasl-lib,libXext,libuuid,cairo,libSM,libXfixes,xmlrpc-c,libXcursor,libtdb,pango,krb5-libs,libXinerama,btparser,libXt,libogg,qt3,libidn,libXv,libgpg-error,libdhash,libnl,ethtool,libcap-ng,libsemanage,libudev,policycoreutils,libtevent,iproute,pcre,util-linux-ng,cpio,udev,file-libs,libdrm,libtirpc,device-mapper,elfutils-libs,usermode,atk,kpartx,psmisc,rsyslog,libtiff,openssh,sysvinit-tools,samba-winbind-clients,lcms-libs,dmraid-events,file,libldb,libtheora,cyrus-sasl-gssapi,nss-softokn,libipa_hbac,libselinux-utils,jasper-libs,avahi-libs,gmp,e2fsprogs,m4,libfontenc,libedit,slang,gdbm,perl-Module-Pluggable,perl-Pod-Simple,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Package-Constants,perl-Term-UI,perl-File-Fetch,perl-Test-Simple,perl-URI,perl-Module-CoreList,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Compress-Raw-Bzip2,perl-DBI,numactl,libusb1,perl-DBIx-Simple,perl-CPAN,perl-Module-Build,perl-parent,perl-CPANPLUS,perl-HTML-Tagset,perl-libwww-perl,perl-XML-Parser,atlas,perl-Time-Piece,xorg-x11-font-utils,tmpwatch,gstreamer-tools,hal-libs,libxslt,tcp_wrappers,eggdbus,db4-utils,libutempter,patch,pinentry,libnih,hunspell,libgomp,libhugetlbfs,vim-common,ncurses,less,python-matplotlib,fprintd,libvisual,phonon-backend-gstreamer,redhat-lsb-graphics,redhat-lsb,pulseaudio-libs,SDL,cloud-init,yum-plugin-security,cas,abrt-cli,iotop,dstat,selinux-policy-targeted,iwl1000-firmware,b43-openfwwf,iwl6050-firmware,iwl5150-firmware,man-pages-overrides,hunspell-en,perl-XML-Grove,perl-XML-Dumper,seekwatcher,fprintd-pam,subscription-manager,vim-enhanced,sysstat,pcmciautils,lvm2,cifs-utils,openssh-clients,setuptool,biosdevname,quota,microcode_ctl,dhclient,smartmontools,ledmon,tcpdump,sudo,usbutils,perl-Crypt-SSLeay,audit,psacct,valgrind,crash-gcore-command,mlocate,cyrus-sasl-plain,latencytop-tui,unzip,nano,attr,scl-utils,mtr,traceroute,trace-cmd,rdate,strace,b43-fwcutter,eject,vconfig,gpg-pubkey,lvm2-libs,cryptsetup-luks,pm-utils,mesa-dri1-drivers,mesa-libGL,plymouth,dracut-kernel,autofs,crda,yp-tools,certmonger,ntp,oddjob-mkhomedir,postfix,cronie,virt-what,libffi,python,python-setuptools,python-pygments,libproxy-bin,libproxy-python,system-config-firewall-base,python-nss,python-netaddr,python-boto,libreport-python,libreport,libreport-compat,abrt-libs,newt-python,dbus-python,python-dmidecode,pyOpenSSL,python-simplejson,nfs-utils-lib,libselinux-python,sos,python-rhsm,abrt-addon-python,libreport-plugin-kerneloops,libreport-plugin-logger,libreport-plugin-mailx,numpy,libipa_hbac-python,redhat-lsb-core,blktrace,python-urlgrabber,audit-libs-python,python-iwlib,python-crypto,python-krbV,pytalloc,ipa-python,yum,rhnsd,yum-rhn-plugin,setools-libs-python,libtasn1,cups-libs,gtk2,ghostscript,foomatic-db,redhat-lsb-printing,cracklib,ca-certificates,sssd,pam,latencytop-common,qt-x11,alsa-lib,dhcp-common,libasyncns,redhat-logos,redhat-release-server,ipa-client,jline,fontpackages-filesystem,yum-utils,libssh2,kbd-misc,system-config-firewall-tui,libpciaccess,ql2500-firmware,perf,mysql-libs,rootfiles,iwl6000-firmware,bind-utils,redhat-indexhtml,iwl6000g2a-firmware,ConsoleKit-libs,iwl3945-firmware,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,sssd-client,ivtv-firmware,perl-XML-Twig,mailx,glibc-common,java-1.6.0-openjdk,xmlrpc-c-client,libattr,libhugetlbfs-utils,rpm,libcom_err,kexec-tools,gpgme,popt,samba-client,libaio,freetype,numad,plymouth-core-libs,libpng,readahead,libini_config,libsepol,rng-tools,hdparm,shadow-utils,prelink,gpm-libs,elfutils-libelf,elinks,libX11,dbus-glib,alsa-utils,libXi,libblkid,tcsh,libXft,keyutils-libs,ntsysv,libXdamage,xz-libs,efibootmgr,libXxf86vm,which,lsof,sg3_utils-libs,pciutils-libs,libitm,mingetty,libgssglue,powertop,iputils,grep,zip,selinux-policy,pkgconfig,libtopology,device-mapper-event-libs,lua,latrace,libcgroup,tar,dosfstools,samba-common,dmidecode,dmraid,crash,hal-info,xz,mesa-dri-drivers,bc,dracut,checkpolicy,mdadm,libusb,ypbind,diffutils,oddjob,libtar,cronie-anacron,newt,iptables-ipv6,perl-libs,python-iniparse,perl-Locale-Maketext-Simple,python-nose,perl-devel,python-configobj,perl-IPC-Cmd,python-markdown,perl-Log-Message-Simple,python-argparse,perl-ExtUtils-CBuilder,libreport-plugin-rhtsupport,perl-Module-Loaded,abrt,perl-Compress-Zlib,python-ethtool,perl-Digest-SHA,m2crypto,libcollection,nfs-utils,perl-DBD-SQLite,python-gudev,perl-ExtUtils-Embed,abrt-tui,perl-CGI,libreport-cli,dejavu-sans-fonts,PyYAML,perl-Time-HiRes,python-ldap,xz-lzma-compat,pygpgme,gstreamer,libsemanage-python,flac,python-lxml,setools-libs,yum-metadata-parser,desktop-file-utils,rhn-setup,portreserve,policycoreutils-python,ed,samba4-libs,dash,foomatic-db-ppds,groff'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-aaf483da",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-0d4bdc64",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "c1.medium",\r\n  "architecture"
            : "i386",\r\n  "kernelId" : "aki-eafa0183",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:11Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.28",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-0d4bdc64" = "ami-0d4bdc64" ]', result: passed}
        - {command: '[ "i386" = "i386" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file:
        - {command: 'parted -l | grep linux-swap | awk ''{print $4}'' | awk -F''MB''
            ''{print $1}''', result: passed, value: '940'}
        - {command: 'parted -l | grep -B 6 swap | grep ''^Disk /'' | awk ''{print
            $2}'' | sed ''$s/.$//'' | head -1', result: passed, value: /dev/xvde3}
        - {command: '[ 940 -gt 0 ]', result: passed}
        - {command: swapoff /dev/xvde3 ; echo, result: passed}
        - {command: swapon /dev/xvde3, result: passed}
        - {command: swapoff /dev/xvde3 && swapon /dev/xvde3, result: passed}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \ti386\r\nStatus:               \tNot Subscribed\r\nStarts:     \
            \          \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-28 ~]# ",
          command: subscription-manager list, expectation: No installed products to
            list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '2',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 39% [=====-         ]  0.0 B/s | 5.5 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 84% [============-  ]  11 MB/s |  12 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 39% [=====-         ]  0.0 B/s | 5.6 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 83% [============-  ]  10 MB/s |  12 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''1752580'']'}
        - {command: '[ 1752580 -gt 1700000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.i686}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.i686}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.i686 = 2.6.32-358.el6.i686 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m1.small:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''1711736'']'}
        - {command: '[ 1711736 -gt 1700000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''libfprint,coreutils-libs,filesystem,gstreamer-plugins-base,fontconfig,foomatic-db-filesystem,redhat-lsb-compat,jpackage-utils,xml-common,java-1.7.0-openjdk,ghostscript-fonts,mailcap,rh-amazon-rhui-client,hicolor-icon-theme,poppler-data,system-config-network-tui,qt-sqlite,rt73usb-firmware,grub,poppler,xorg-x11-drv-ati-firmware,aic94xx-firmware,fipscheck,ql2400-firmware,bfa-firmware,cvs,ipw2100-firmware,iwl100-firmware,ConsoleKit,iwl4965-firmware,perl-core,nss,libgcc,theora-tools,openldap,ncurses-libs,latencytop,curl,zlib,gdb,libuser,dbus-libs,systemtap-runtime,logrotate,nspr,openssh-server,libyaml,libacl,parted,libsss_idmap,bzip2-libs,cpuspeed,liboil,gamin,acpid,pax,libtalloc,hwloc,libXau,sqlite,pinfo,libXrender,libICE,pam_passwdqc,libXtst,tcp_wrappers-libs,irqbalance,libXrandr,findutils,oprofile,giflib,procps,ltrace,libXcomposite,libgcrypt,rsync,ustr,dbus,nfs4-acl-tools,iptables,bzip2,bridge-utils,initscripts,binutils,rfkill,device-mapper-libs,libvorbis,crash-trace-command,device-mapper-event,net-tools,setserial,kbd,e2fsprogs-libs,gpg-pubkey,samba-winbind,libmng,cryptsetup-luks-libs,libgudev1,hal,keyutils,mesa-libGLU,vim-minimal,kernel,acl,wireless-tools,libss,ntpdate,make,cyrus-sasl,pth,crontabs,perl-Pod-Escapes,python-libs,perl-version,python-dateutil,perl-Test-Harness,libproxy,perl-Module-Load,pytz,perl-IO-Compress-Base,python-prettytable,perl-Archive-Extract,libreport-plugin-reportuploader,perl-Object-Accessor,rpm-python,perl-Compress-Raw-Zlib,libxml2-python,perl-Archive-Tar,authconfig,openjpeg-libs,pygobject2,libgfortran,rhnlib,perl-IO-Compress-Bzip2,abrt-addon-ccpp,perl-Parse-CPAN-Meta,abrt-addon-kerneloops,perl-HTML-Parser,python-cheetah,perl-libxml-perl,gettext,libXfont,python-pycurl,elfutils,pycairo,iw,python-paramiko,grubby,python-kerberos,MAKEDEV,rhn-client-tools,device-mapper-persistent-data,rhn-check,upstart,gnutls,time,cups,cdparanoia-libs,foomatic,gzip,setup,cracklib-dicts,tzdata,coreutils,mesa-dri-filesystem,openssl,tzdata-java,module-init-tools,basesystem,hwdata,ncurses-base,xdg-utils,iso-codes,plymouth-scripts,busybox,urw-fonts,kernel-firmware,rhino,dejavu-fonts-common,qt,libX11-common,rpcbind,ql2200-firmware,pciutils,ql23xx-firmware,libsndfile,zd1211-firmware,poppler-utils,libertas-usb8388-firmware,fipscheck-lib,iwl5000-firmware,bind-libs,atmel-firmware,wget,rt61pci-firmware,krb5-workstation,words,polkit,man-pages,at,ql2100-firmware,pam_krb5,ipw2200-firmware,nss-sysinit,nss-softokn-freebl,nss-tools,glibc,libcurl,bash,gnupg2,libcap,rpm-libs,info,man,libstdc++,passwd,libxml2,nss_compat_ossl,chkconfig,libpath_utils,audit-libs,c-ares,nss-util,pixman,gawk,libthai,libjpeg-turbo,libref_array,expat,hesiod,libselinux,libsss_autofs,glib2,sgpio,sed,libevent,db4,libpcap,readline,libxcb,cyrus-sasl-lib,libXext,libuuid,cairo,libSM,libXfixes,xmlrpc-c,libXcursor,libtdb,pango,krb5-libs,libXinerama,btparser,libXt,libogg,qt3,libidn,libXv,libgpg-error,libdhash,libnl,ethtool,libcap-ng,libsemanage,libudev,policycoreutils,libtevent,iproute,pcre,util-linux-ng,cpio,udev,file-libs,libdrm,libtirpc,device-mapper,elfutils-libs,usermode,atk,kpartx,psmisc,rsyslog,libtiff,openssh,sysvinit-tools,samba-winbind-clients,lcms-libs,dmraid-events,file,libldb,libtheora,cyrus-sasl-gssapi,nss-softokn,libipa_hbac,libselinux-utils,jasper-libs,avahi-libs,gmp,e2fsprogs,m4,libfontenc,libedit,slang,gdbm,perl-Module-Pluggable,perl-Pod-Simple,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Package-Constants,perl-Term-UI,perl-File-Fetch,perl-Test-Simple,perl-URI,perl-Module-CoreList,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Compress-Raw-Bzip2,perl-DBI,numactl,libusb1,perl-DBIx-Simple,perl-CPAN,perl-Module-Build,perl-parent,perl-CPANPLUS,perl-HTML-Tagset,perl-libwww-perl,perl-XML-Parser,atlas,perl-Time-Piece,xorg-x11-font-utils,tmpwatch,gstreamer-tools,hal-libs,libxslt,tcp_wrappers,eggdbus,db4-utils,libutempter,patch,pinentry,libnih,hunspell,libgomp,libhugetlbfs,vim-common,ncurses,less,python-matplotlib,fprintd,libvisual,phonon-backend-gstreamer,redhat-lsb-graphics,redhat-lsb,pulseaudio-libs,SDL,cloud-init,yum-plugin-security,cas,abrt-cli,iotop,dstat,selinux-policy-targeted,iwl1000-firmware,b43-openfwwf,iwl6050-firmware,iwl5150-firmware,man-pages-overrides,hunspell-en,perl-XML-Grove,perl-XML-Dumper,seekwatcher,fprintd-pam,subscription-manager,vim-enhanced,sysstat,pcmciautils,lvm2,cifs-utils,openssh-clients,setuptool,biosdevname,quota,microcode_ctl,dhclient,smartmontools,ledmon,tcpdump,sudo,usbutils,perl-Crypt-SSLeay,audit,psacct,valgrind,crash-gcore-command,mlocate,cyrus-sasl-plain,latencytop-tui,unzip,nano,attr,scl-utils,mtr,traceroute,trace-cmd,rdate,strace,b43-fwcutter,eject,vconfig,gpg-pubkey,lvm2-libs,cryptsetup-luks,pm-utils,mesa-dri1-drivers,mesa-libGL,plymouth,dracut-kernel,autofs,crda,yp-tools,certmonger,ntp,oddjob-mkhomedir,postfix,cronie,virt-what,libffi,python,python-setuptools,python-pygments,libproxy-bin,libproxy-python,system-config-firewall-base,python-nss,python-netaddr,python-boto,libreport-python,libreport,libreport-compat,abrt-libs,newt-python,dbus-python,python-dmidecode,pyOpenSSL,python-simplejson,nfs-utils-lib,libselinux-python,sos,python-rhsm,abrt-addon-python,libreport-plugin-kerneloops,libreport-plugin-logger,libreport-plugin-mailx,numpy,libipa_hbac-python,redhat-lsb-core,blktrace,python-urlgrabber,audit-libs-python,python-iwlib,python-crypto,python-krbV,pytalloc,ipa-python,yum,rhnsd,yum-rhn-plugin,setools-libs-python,libtasn1,cups-libs,gtk2,ghostscript,foomatic-db,redhat-lsb-printing,cracklib,ca-certificates,sssd,pam,latencytop-common,qt-x11,alsa-lib,dhcp-common,libasyncns,redhat-logos,redhat-release-server,ipa-client,jline,fontpackages-filesystem,yum-utils,libssh2,kbd-misc,system-config-firewall-tui,libpciaccess,ql2500-firmware,perf,mysql-libs,rootfiles,iwl6000-firmware,bind-utils,redhat-indexhtml,iwl6000g2a-firmware,ConsoleKit-libs,iwl3945-firmware,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,sssd-client,ivtv-firmware,perl-XML-Twig,mailx,glibc-common,java-1.6.0-openjdk,xmlrpc-c-client,libattr,libhugetlbfs-utils,rpm,libcom_err,kexec-tools,gpgme,popt,samba-client,libaio,freetype,numad,plymouth-core-libs,libpng,readahead,libini_config,libsepol,rng-tools,hdparm,shadow-utils,prelink,gpm-libs,elfutils-libelf,elinks,libX11,dbus-glib,alsa-utils,libXi,libblkid,tcsh,libXft,keyutils-libs,ntsysv,libXdamage,xz-libs,efibootmgr,libXxf86vm,which,lsof,sg3_utils-libs,pciutils-libs,libitm,mingetty,libgssglue,powertop,iputils,grep,zip,selinux-policy,pkgconfig,libtopology,device-mapper-event-libs,lua,latrace,libcgroup,tar,dosfstools,samba-common,dmidecode,dmraid,crash,hal-info,xz,mesa-dri-drivers,bc,dracut,checkpolicy,mdadm,libusb,ypbind,diffutils,oddjob,libtar,cronie-anacron,newt,iptables-ipv6,perl-libs,python-iniparse,perl-Locale-Maketext-Simple,python-nose,perl-devel,python-configobj,perl-IPC-Cmd,python-markdown,perl-Log-Message-Simple,python-argparse,perl-ExtUtils-CBuilder,libreport-plugin-rhtsupport,perl-Module-Loaded,abrt,perl-Compress-Zlib,python-ethtool,perl-Digest-SHA,m2crypto,libcollection,nfs-utils,perl-DBD-SQLite,python-gudev,perl-ExtUtils-Embed,abrt-tui,perl-CGI,libreport-cli,dejavu-sans-fonts,PyYAML,perl-Time-HiRes,python-ldap,xz-lzma-compat,pygpgme,gstreamer,libsemanage-python,flac,python-lxml,setools-libs,yum-metadata-parser,desktop-file-utils,rhn-setup,portreserve,policycoreutils-python,ed,samba4-libs,dash,foomatic-db-ppds,groff'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-b4f483c4",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-0d4bdc64",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "m1.small",\r\n  "architecture"
            : "i386",\r\n  "kernelId" : "aki-eafa0183",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:08Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.35",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-0d4bdc64" = "ami-0d4bdc64" ]', result: passed}
        - {command: '[ "i386" = "i386" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file:
        - {command: 'parted -l | grep linux-swap | awk ''{print $4}'' | awk -F''MB''
            ''{print $1}''', result: passed, value: '940'}
        - {command: 'parted -l | grep -B 6 swap | grep ''^Disk /'' | awk ''{print
            $2}'' | sed ''$s/.$//'' | head -1', result: passed, value: /dev/xvde3}
        - {command: '[ 940 -gt 0 ]', result: passed}
        - {command: swapoff /dev/xvde3 ; echo, result: passed}
        - {command: swapon /dev/xvde3, result: passed}
        - {command: swapoff /dev/xvde3 && swapon /dev/xvde3, result: passed}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \ti386\r\nStatus:               \tNot Subscribed\r\nStarts:     \
            \          \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-35 ~]# ",
          command: subscription-manager list, expectation: No installed products to
            list, result: failed}
        testcase_32_ephemeral:
        - {command: fdisk -l /dev/xvdj | grep ^Disk, result: passed}
        - {command: grep "/dev/xvdj " /proc/mounts  | wc -l, result: passed, value: '0'}
        - {command: ls -la /sbin/mkfs.vfat 2> /dev/null | wc -l, result: passed, value: '1'}
        - {command: mkfs.vfat -I /dev/xvdj, result: passed}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '1',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 22% [===            ]  0.0 B/s | 3.2 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 44% [======-        ] 5.2 MB/s | 6.4 MB     00:01 ETA \rrhui-us-east-1-rhel-serve\
            \ 67% [==========     ] 5.5 MB/s | 9.5 MB     00:00 ETA \rrhui-us-east-1-rhel-serve\
            \ 91% [=============- ] 5.8 MB/s |  13 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:01     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 22% [===            ]  0.0 B/s | 3.2 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 45% [======-        ] 5.4 MB/s | 6.4 MB     00:01 ETA \rrhui-us-east-1-rhel-serve\
            \ 68% [==========     ] 5.7 MB/s | 9.7 MB     00:00 ETA \rrhui-us-east-1-rhel-serve\
            \ 91% [=============- ] 6.0 MB/s |  13 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:01     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''1711736'']'}
        - {command: '[ 1711736 -gt 1700000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.i686}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.i686}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.i686 = 2.6.32-358.el6.i686 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    t1.micro:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        - {command: 'grep ''(hd0,0)'' /boot/grub/grub.conf', result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''610224'']'}
        - {command: '[ 610224 -gt 600000 ]', result: passed}
        testcase_09_nameserver:
        - {actual: '1', command: dig clock.redhat.com | grep 66.187.233.4, result: failed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''libfprint,coreutils-libs,filesystem,gstreamer-plugins-base,fontconfig,foomatic-db-filesystem,redhat-lsb-compat,jpackage-utils,xml-common,java-1.7.0-openjdk,ghostscript-fonts,mailcap,rh-amazon-rhui-client,hicolor-icon-theme,poppler-data,system-config-network-tui,qt-sqlite,rt73usb-firmware,grub,poppler,xorg-x11-drv-ati-firmware,aic94xx-firmware,fipscheck,ql2400-firmware,bfa-firmware,cvs,ipw2100-firmware,iwl100-firmware,ConsoleKit,iwl4965-firmware,perl-core,nss,libgcc,theora-tools,openldap,ncurses-libs,latencytop,curl,zlib,gdb,libuser,dbus-libs,systemtap-runtime,logrotate,nspr,openssh-server,libyaml,libacl,parted,libsss_idmap,bzip2-libs,cpuspeed,liboil,gamin,acpid,pax,libtalloc,hwloc,libXau,sqlite,pinfo,libXrender,libICE,pam_passwdqc,libXtst,tcp_wrappers-libs,irqbalance,libXrandr,findutils,oprofile,giflib,procps,ltrace,libXcomposite,libgcrypt,rsync,ustr,dbus,nfs4-acl-tools,iptables,bzip2,bridge-utils,initscripts,binutils,rfkill,device-mapper-libs,libvorbis,crash-trace-command,device-mapper-event,net-tools,setserial,kbd,e2fsprogs-libs,gpg-pubkey,samba-winbind,libmng,cryptsetup-luks-libs,libgudev1,hal,keyutils,mesa-libGLU,vim-minimal,kernel,acl,wireless-tools,libss,ntpdate,make,cyrus-sasl,pth,crontabs,perl-Pod-Escapes,python-libs,perl-version,python-dateutil,perl-Test-Harness,libproxy,perl-Module-Load,pytz,perl-IO-Compress-Base,python-prettytable,perl-Archive-Extract,libreport-plugin-reportuploader,perl-Object-Accessor,rpm-python,perl-Compress-Raw-Zlib,libxml2-python,perl-Archive-Tar,authconfig,openjpeg-libs,pygobject2,libgfortran,rhnlib,perl-IO-Compress-Bzip2,abrt-addon-ccpp,perl-Parse-CPAN-Meta,abrt-addon-kerneloops,perl-HTML-Parser,python-cheetah,perl-libxml-perl,gettext,libXfont,python-pycurl,elfutils,pycairo,iw,python-paramiko,grubby,python-kerberos,MAKEDEV,rhn-client-tools,device-mapper-persistent-data,rhn-check,upstart,gnutls,time,cups,cdparanoia-libs,foomatic,gzip,setup,cracklib-dicts,tzdata,coreutils,mesa-dri-filesystem,openssl,tzdata-java,module-init-tools,basesystem,hwdata,ncurses-base,xdg-utils,iso-codes,plymouth-scripts,busybox,urw-fonts,kernel-firmware,rhino,dejavu-fonts-common,qt,libX11-common,rpcbind,ql2200-firmware,pciutils,ql23xx-firmware,libsndfile,zd1211-firmware,poppler-utils,libertas-usb8388-firmware,fipscheck-lib,iwl5000-firmware,bind-libs,atmel-firmware,wget,rt61pci-firmware,krb5-workstation,words,polkit,man-pages,at,ql2100-firmware,pam_krb5,ipw2200-firmware,nss-sysinit,nss-softokn-freebl,nss-tools,glibc,libcurl,bash,gnupg2,libcap,rpm-libs,info,man,libstdc++,passwd,libxml2,nss_compat_ossl,chkconfig,libpath_utils,audit-libs,c-ares,nss-util,pixman,gawk,libthai,libjpeg-turbo,libref_array,expat,hesiod,libselinux,libsss_autofs,glib2,sgpio,sed,libevent,db4,libpcap,readline,libxcb,cyrus-sasl-lib,libXext,libuuid,cairo,libSM,libXfixes,xmlrpc-c,libXcursor,libtdb,pango,krb5-libs,libXinerama,btparser,libXt,libogg,qt3,libidn,libXv,libgpg-error,libdhash,libnl,ethtool,libcap-ng,libsemanage,libudev,policycoreutils,libtevent,iproute,pcre,util-linux-ng,cpio,udev,file-libs,libdrm,libtirpc,device-mapper,elfutils-libs,usermode,atk,kpartx,psmisc,rsyslog,libtiff,openssh,sysvinit-tools,samba-winbind-clients,lcms-libs,dmraid-events,file,libldb,libtheora,cyrus-sasl-gssapi,nss-softokn,libipa_hbac,libselinux-utils,jasper-libs,avahi-libs,gmp,e2fsprogs,m4,libfontenc,libedit,slang,gdbm,perl-Module-Pluggable,perl-Pod-Simple,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Package-Constants,perl-Term-UI,perl-File-Fetch,perl-Test-Simple,perl-URI,perl-Module-CoreList,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Compress-Raw-Bzip2,perl-DBI,numactl,libusb1,perl-DBIx-Simple,perl-CPAN,perl-Module-Build,perl-parent,perl-CPANPLUS,perl-HTML-Tagset,perl-libwww-perl,perl-XML-Parser,atlas,perl-Time-Piece,xorg-x11-font-utils,tmpwatch,gstreamer-tools,hal-libs,libxslt,tcp_wrappers,eggdbus,db4-utils,libutempter,patch,pinentry,libnih,hunspell,libgomp,libhugetlbfs,vim-common,ncurses,less,python-matplotlib,fprintd,libvisual,phonon-backend-gstreamer,redhat-lsb-graphics,redhat-lsb,pulseaudio-libs,SDL,cloud-init,yum-plugin-security,cas,abrt-cli,iotop,dstat,selinux-policy-targeted,iwl1000-firmware,b43-openfwwf,iwl6050-firmware,iwl5150-firmware,man-pages-overrides,hunspell-en,perl-XML-Grove,perl-XML-Dumper,seekwatcher,fprintd-pam,subscription-manager,vim-enhanced,sysstat,pcmciautils,lvm2,cifs-utils,openssh-clients,setuptool,biosdevname,quota,microcode_ctl,dhclient,smartmontools,ledmon,tcpdump,sudo,usbutils,perl-Crypt-SSLeay,audit,psacct,valgrind,crash-gcore-command,mlocate,cyrus-sasl-plain,latencytop-tui,unzip,nano,attr,scl-utils,mtr,traceroute,trace-cmd,rdate,strace,b43-fwcutter,eject,vconfig,gpg-pubkey,lvm2-libs,cryptsetup-luks,pm-utils,mesa-dri1-drivers,mesa-libGL,plymouth,dracut-kernel,autofs,crda,yp-tools,certmonger,ntp,oddjob-mkhomedir,postfix,cronie,virt-what,libffi,python,python-setuptools,python-pygments,libproxy-bin,libproxy-python,system-config-firewall-base,python-nss,python-netaddr,python-boto,libreport-python,libreport,libreport-compat,abrt-libs,newt-python,dbus-python,python-dmidecode,pyOpenSSL,python-simplejson,nfs-utils-lib,libselinux-python,sos,python-rhsm,abrt-addon-python,libreport-plugin-kerneloops,libreport-plugin-logger,libreport-plugin-mailx,numpy,libipa_hbac-python,redhat-lsb-core,blktrace,python-urlgrabber,audit-libs-python,python-iwlib,python-crypto,python-krbV,pytalloc,ipa-python,yum,rhnsd,yum-rhn-plugin,setools-libs-python,libtasn1,cups-libs,gtk2,ghostscript,foomatic-db,redhat-lsb-printing,cracklib,ca-certificates,sssd,pam,latencytop-common,qt-x11,alsa-lib,dhcp-common,libasyncns,redhat-logos,redhat-release-server,ipa-client,jline,fontpackages-filesystem,yum-utils,libssh2,kbd-misc,system-config-firewall-tui,libpciaccess,ql2500-firmware,perf,mysql-libs,rootfiles,iwl6000-firmware,bind-utils,redhat-indexhtml,iwl6000g2a-firmware,ConsoleKit-libs,iwl3945-firmware,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,sssd-client,ivtv-firmware,perl-XML-Twig,mailx,glibc-common,java-1.6.0-openjdk,xmlrpc-c-client,libattr,libhugetlbfs-utils,rpm,libcom_err,kexec-tools,gpgme,popt,samba-client,libaio,freetype,numad,plymouth-core-libs,libpng,readahead,libini_config,libsepol,rng-tools,hdparm,shadow-utils,prelink,gpm-libs,elfutils-libelf,elinks,libX11,dbus-glib,alsa-utils,libXi,libblkid,tcsh,libXft,keyutils-libs,ntsysv,libXdamage,xz-libs,efibootmgr,libXxf86vm,which,lsof,sg3_utils-libs,pciutils-libs,libitm,mingetty,libgssglue,powertop,iputils,grep,zip,selinux-policy,pkgconfig,libtopology,device-mapper-event-libs,lua,latrace,libcgroup,tar,dosfstools,samba-common,dmidecode,dmraid,crash,hal-info,xz,mesa-dri-drivers,bc,dracut,checkpolicy,mdadm,libusb,ypbind,diffutils,oddjob,libtar,cronie-anacron,newt,iptables-ipv6,perl-libs,python-iniparse,perl-Locale-Maketext-Simple,python-nose,perl-devel,python-configobj,perl-IPC-Cmd,python-markdown,perl-Log-Message-Simple,python-argparse,perl-ExtUtils-CBuilder,libreport-plugin-rhtsupport,perl-Module-Loaded,abrt,perl-Compress-Zlib,python-ethtool,perl-Digest-SHA,m2crypto,libcollection,nfs-utils,perl-DBD-SQLite,python-gudev,perl-ExtUtils-Embed,abrt-tui,perl-CGI,libreport-cli,dejavu-sans-fonts,PyYAML,perl-Time-HiRes,python-ldap,xz-lzma-compat,pygpgme,gstreamer,libsemanage-python,flac,python-lxml,setools-libs,yum-metadata-parser,desktop-file-utils,rhn-setup,portreserve,policycoreutils-python,ed,samba4-libs,dash,foomatic-db-ppds,groff'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs:
        - {command: df -h | grep 15G, result: passed}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-baf483ca",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-0d4bdc64",\r\n  "accountId"
            : "337935342288",\r\n  "instanceType" : "t1.micro",\r\n  "architecture"
            : "i386",\r\n  "kernelId" : "aki-eafa0183",\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-05T13:13:08Z",\r\n  "availabilityZone" : "us-east-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.3.94.34",\r\n  "region" : "us-east-1"\r\n}'']'}
        - {command: '[ "ami-0d4bdc64" = "ami-0d4bdc64" ]', result: passed}
        - {command: '[ "i386" = "i386" ]', result: passed}
        - {command: '[ "us-east-1" = "us-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvde1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvde1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvde1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_26_verify_rpms:
        - {command: rpm -Va --nomtime --nosize --nomd5 | sort -fu | wc -l, result: passed,
          value: '6'}
        - {command: 'rpm -q --queryformat ''%{RELEASE}

            '' redhat-release-server | cut -d. -f1,2', result: passed, value: '6.4'}
        - {actual: '1', command: '[ 6 = 5 ]', result: failed}
        - {command: '[ 6.4 = 6.4 ]', result: passed}
        - {command: 'rpm -qa --queryformat ''%{PACKAGER}

            '' | sort -u | grep -v ''Red Hat, Inc.''', result: passed, value: "Lai\
            \ Jiangshan <laijs@cn.fujitsu.com>\r\n(none)"}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhui-us-east-1-client-config-server-6: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: failed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for ec2name = t1.micro, result: skipped}
        testcase_30_rhn_certificates:
        - {command: rpm -ql rh-amazon-rhui-client | egrep '.*\.(pem|crt)', result: passed,
          value: "/etc/pki/entitlement/ca.crt\r\n/etc/pki/entitlement/cdn.redhat.com-chain.crt\r\
            \n/etc/pki/entitlement/product/content-rhel6.crt\r\n/etc/pki/entitlement/product/rhui-client-config-server-6.crt"}
        - {command: openssl x509 -in /etc/pki/entitlement/ca.crt -noout -dates | grep
            notAfter, result: passed, value: 'notAfter=Nov 30 19:46:02 2017 GMT'}
        - {comment: '(/etc/pki/entitlement/ca.crt).notAfter=2017-11-30 19:46:02; expecting:
            2020-11-10 00:00:00', result: failed}
        - {command: openssl x509 -in /etc/pki/entitlement/cdn.redhat.com-chain.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Mar 13
            11:24:54 2030 GMT'}
        - {comment: '(/etc/pki/entitlement/cdn.redhat.com-chain.crt).notAfter=2030-03-13
            11:24:54; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/content-rhel6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:31:28 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/content-rhel6.crt).notAfter=2020-11-30
            18:31:28; expecting: 2020-11-10 00:00:00', result: passed}
        - {command: openssl x509 -in /etc/pki/entitlement/product/rhui-client-config-server-6.crt
            -noout -dates | grep notAfter, result: passed, value: 'notAfter=Nov 30
            18:38:07 2020 GMT'}
        - {comment: '(/etc/pki/entitlement/product/rhui-client-config-server-6.crt).notAfter=2020-11-30
            18:38:07; expecting: 2020-11-10 00:00:00', result: passed}
        testcase_31_subscription_management:
        - {command: yum --disablerepo="*" -v repolist, expectation: Not loading "subscription-manager"
            plugin, result: passed}
        - {command: yum --enableplugin=subscription-manager --disablerepo="*" -v repolist,
          expectation: Loading "subscription-manager" plugin, result: passed}
        - {actual: "subscription-manager list\r\n+-------------------------------------------+\r\
            \n    Installed Product Status\r\n+-------------------------------------------+\r\
            \nProduct Name:         \tRed Hat Enterprise Linux Server\r\nProduct ID:\
            \           \t69\r\nVersion:              \t6.4\r\nArch:             \
            \    \ti386\r\nStatus:               \tNot Subscribed\r\nStarts:     \
            \          \t\r\nEnds:                 \t\r\n\r\n[root@ip-10-3-94-34 ~]# ",
          command: subscription-manager list, expectation: No installed products to
            list, result: failed}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '1',
          result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_55_yum_group_install:
        - {actual: '1', command: yum -y groupinstall 'Development tools', result: failed}
        testcase_60_yum_update:
        - {command: head -c $((1024*1024*1024)) /dev/zero > /swap && echo SUCCESS,
          expectation: "\r\nSUCCESS\r\n", result: passed}
        - {command: mkswap /swap, result: passed}
        - {command: echo '/swap    swap     swap    defaults     0 0' >> /etc/fstab
            && echo SUCCESS, expectation: "\r\nSUCCESS\r\n", result: passed}
        - {actual: '255', command: swapon -a, result: failed}
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {command: yum --disablerepo=* --enablerepo=rhui-us-east-1-client-config-server-6
            --nogpgcheck update -y, result: passed}
        - {command: cat /etc/yum.repos.d/rhui-load-balancers.conf, result: passed,
          value: rhui2-cds01-stage.us-east-1.aws.ce.redhat.com}
        - {command: iptables -I OUTPUT -d rhui2-cds01-stage.us-east-1.aws.ce.redhat.com
            -j DROP, result: passed}
        - {command: yum clean all; yum repolist, result: passed, value: "Loaded plugins:\
            \ amazon-id, rhui-lb, security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\
            \n              : rhui-us-east-1-rhel-server-releases\r\n            \
            \  : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 35% [=====          ]  0.0 B/s | 5.0 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 78% [===========-   ]  10 MB/s |  11 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: 'yum clean all; https_proxy=''https://rhui-client:,Ykvf+gH@10.3.94.27:3128''
            yum repolist', result: passed, value: "Loaded plugins: amazon-id, rhui-lb,\
            \ security\r\nCleaning repos: rhui-us-east-1-client-config-server-6\r\n\
            \              : rhui-us-east-1-rhel-server-releases\r\n             \
            \ : rhui-us-east-1-rhel-server-releases-optional\r\nCleaning up Everything\r\
            \nLoaded plugins: amazon-id, rhui-lb, security\r\n\rrhui-us-east-1-client-config-server-6\
            \                    | 1.3 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6/primary\
            \            | 1.0 kB     00:00     \r\n\rrhui-us-east-1-client-config-server-6\
            \                                       1/1\r\n\rrhui-us-east-1-rhel-server-releases\
            \                      | 3.7 kB     00:00     \r\nrhui-us-east-1-rhel-serve\
            \ 30% [====-          ]  0.0 B/s | 4.3 MB     --:-- ETA \rrhui-us-east-1-rhel-serve\
            \ 71% [==========-    ] 9.8 MB/s |  10 MB     00:00 ETA \r\rrhui-us-east-1-rhel-server-releases/primary_db\
            \           |  14 MB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional\
            \             | 3.5 kB     00:00     \r\n\rrhui-us-east-1-rhel-server-releases-optional/primary_db\
            \  | 1.6 MB     00:00     \r\nrepo id                                \
            \      repo name                    status\r\nrhui-us-east-1-client-config-server-6\
            \        Red Hat Update Infrastructur     1\r\nrhui-us-east-1-rhel-server-releases\
            \          Red Hat Enterprise Linux Ser 6,481\r\nrhui-us-east-1-rhel-server-releases-optional\
            \ Red Hat Enterprise Linux Ser 3,735\r\nrepolist: 10,217"}
        - {command: service iptables restart, result: passed}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''610224'']'}
        - {command: '[ 610224 -gt 600000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.i686}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.i686}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.i686 = 2.6.32-358.el6.i686 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
