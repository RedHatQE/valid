- ami: ami-7bda0166
  arch: x86_64
  product: rhel
  region: sa-east-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-bcf478a2",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-7bda0166",\r\n  "region"
            : "sa-east-1",\r\n  "accountId" : "567014786890",\r\n  "instanceType"
            : "m3.2xlarge",\r\n  "architecture" : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId"
            : null,\r\n  "pendingTime" : "2013-02-15T10:35:54Z",\r\n  "availabilityZone"
            : "sa-east-1a",\r\n  "devpayProductCodes" : null,\r\n  "privateIp" : "10.248.114.17"\r\n}'']'}
        - {command: '[ "ami-7bda0166" = "ami-7bda0166" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "sa-east-1" = "sa-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-sa-east-1-client-config-server-6: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-sa-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-sa-east-1-client-config-server-6: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-sa-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-bef478a0",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-7bda0166",\r\n  "region"
            : "sa-east-1",\r\n  "accountId" : "567014786890",\r\n  "instanceType"
            : "m3.xlarge",\r\n  "architecture" : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId"
            : null,\r\n  "pendingTime" : "2013-02-15T10:35:52Z",\r\n  "availabilityZone"
            : "sa-east-1a",\r\n  "devpayProductCodes" : null,\r\n  "privateIp" : "10.248.114.138"\r\n}'']'}
        - {command: '[ "ami-7bda0166" = "ami-7bda0166" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "sa-east-1" = "sa-east-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-sa-east-1-client-config-server-6: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-sa-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-sa-east-1-client-config-server-6: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-sa-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-f7890ef6
  arch: x86_64
  product: rhel
  region: ap-northeast-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-0d614a0e",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-f7890ef6",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:36:25Z",\r\n  "availabilityZone" : "ap-northeast-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.132.152.247",\r\n  "region" : "ap-northeast-1"\r\n}'']'}
        - {command: '[ "ami-f7890ef6" = "ami-f7890ef6" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-northeast-1" = "ap-northeast-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-northeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-northeast-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-northeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-northeast-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-0f614a0c",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-f7890ef6",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:36:24Z",\r\n  "availabilityZone" : "ap-northeast-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.121.13.224",\r\n  "region" : "ap-northeast-1"\r\n}'']'}
        - {command: '[ "ami-f7890ef6" = "ami-f7890ef6" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-northeast-1" = "ap-northeast-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-northeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-northeast-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-northeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-northeast-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-f5890ef4
  arch: x86_64
  product: rhel
  region: ap-northeast-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-f96249fa",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-f5890ef4",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:36:12Z",\r\n  "availabilityZone" : "ap-northeast-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.132.151.230",\r\n  "region" : "ap-northeast-1"\r\n}'']'}
        - {command: '[ "ami-f5890ef4" = "ami-f5890ef4" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-northeast-1" = "ap-northeast-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-northeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-northeast-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-northeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-northeast-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-f56249f6",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-f5890ef4",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:36:10Z",\r\n  "availabilityZone" : "ap-northeast-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.121.12.166",\r\n  "region" : "ap-northeast-1"\r\n}'']'}
        - {command: '[ "ami-f5890ef4" = "ami-f5890ef4" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-northeast-1" = "ap-northeast-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-northeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-northeast-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-northeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-northeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-northeast-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-8038aeba
  arch: x86_64
  product: rhel
  region: ap-southeast-2
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-f25e58c8",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-8038aeba",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:34:52Z",\r\n  "availabilityZone" : "ap-southeast-2a",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.248.35.245",\r\n  "region" : "ap-southeast-2"\r\n}'']'}
        - {command: '[ "ami-8038aeba" = "ami-8038aeba" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-southeast-2" = "ap-southeast-2" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-2-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-2-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-fc5e58c6",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-8038aeba",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:34:52Z",\r\n  "availabilityZone" : "ap-southeast-2a",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.248.37.70",\r\n  "region" : "ap-southeast-2"\r\n}'']'}
        - {command: '[ "ami-8038aeba" = "ami-8038aeba" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-southeast-2" = "ap-southeast-2" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-2-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-2-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-20416365
  arch: x86_64
  product: rhel
  region: us-west-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-7fc42c27",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-20416365",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:01Z",\r\n  "availabilityZone" : "us-west-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.197.2.160",\r\n  "region" : "us-west-1"\r\n}'']'}
        - {command: '[ "ami-20416365" = "ami-20416365" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-1" = "us-west-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-1-client-config-server-6: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-1-client-config-server-6: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-7dc42c25",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-20416365",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:01Z",\r\n  "availabilityZone" : "us-west-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.197.3.103",\r\n  "region" : "us-west-1"\r\n}'']'}
        - {command: '[ "ami-20416365" = "ami-20416365" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-1" = "us-west-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-1-client-config-server-6: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-1-client-config-server-6: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-ea501db8
  arch: x86_64
  product: rhel
  region: ap-southeast-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-c3ea6494",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-ea501db8",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:36:39Z",\r\n  "availabilityZone" : "ap-southeast-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.144.83.56",\r\n  "region" : "ap-southeast-1"\r\n}'']'}
        - {command: '[ "ami-ea501db8" = "ami-ea501db8" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-southeast-1" = "ap-southeast-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-c5ea6492",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-ea501db8",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:36:38Z",\r\n  "availabilityZone" : "ap-southeast-1a",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.148.64.5",\r\n  "region" : "ap-southeast-1"\r\n}'']'}
        - {command: '[ "ami-ea501db8" = "ami-ea501db8" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-southeast-1" = "ap-southeast-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-5875ff68
  arch: x86_64
  product: rhel
  region: us-west-2
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-54dcbd66",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-5875ff68",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "cc2.8xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:24Z",\r\n  "availabilityZone" : "us-west-2c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.244.68.190",\r\n  "region" : "us-west-2"\r\n}'']'}
        - {command: '[ "ami-5875ff68" = "ami-5875ff68" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-2" = "us-west-2" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '32',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-56dcbd64",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-5875ff68",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:24Z",\r\n  "availabilityZone" : "us-west-2b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.253.33.119",\r\n  "region" : "us-west-2"\r\n}'']'}
        - {command: '[ "ami-5875ff68" = "ami-5875ff68" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-2" = "us-west-2" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-50dcbd62",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-5875ff68",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:24Z",\r\n  "availabilityZone" : "us-west-2c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.245.1.48",\r\n  "region" : "us-west-2"\r\n}'']'}
        - {command: '[ "ami-5875ff68" = "ami-5875ff68" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-2" = "us-west-2" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-ecf6ff98
  arch: x86_64
  product: rhel
  region: eu-west-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-9c3099d6",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-ecf6ff98",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "cc2.8xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:34:29Z",\r\n  "availabilityZone" : "eu-west-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.36.2.108",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-ecf6ff98" = "ami-ecf6ff98" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '32',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cg1.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''23146704'']'}
        - {command: '[ 23146704 -gt 22000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-923099d8",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-ecf6ff98",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "cg1.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:34:30Z",\r\n  "availabilityZone" : "eu-west-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.36.5.83",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-ecf6ff98" = "ami-ecf6ff98" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '16',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''23146704'']'}
        - {command: '[ 23146704 -gt 22000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62535708'']'}
        - {command: '[ 62535708 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-a83099e2",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-ecf6ff98",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "hi1.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:34:40Z",\r\n  "availabilityZone" : "eu-west-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.36.69.34",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-ecf6ff98" = "ami-ecf6ff98" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '16',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62535708'']'}
        - {command: '[ 62535708 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-8e3099c4",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-ecf6ff98",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:34:19Z",\r\n  "availabilityZone" : "eu-west-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.39.61.99",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-ecf6ff98" = "ami-ecf6ff98" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-883099c2",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-ecf6ff98",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:34:19Z",\r\n  "availabilityZone" : "eu-west-1a",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.33.198.67",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-ecf6ff98" = "ami-ecf6ff98" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-22416367
  arch: x86_64
  product: rhel
  region: us-west-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-65c42c3d",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-22416367",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:12Z",\r\n  "availabilityZone" : "us-west-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.197.2.131",\r\n  "region" : "us-west-1"\r\n}'']'}
        - {command: '[ "ami-22416367" = "ami-22416367" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-1" = "us-west-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-1-client-config-server-6: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-1-client-config-server-6: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-7bc42c23",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-22416367",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:01Z",\r\n  "availabilityZone" : "us-west-1c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.197.3.43",\r\n  "region" : "us-west-1"\r\n}'']'}
        - {command: '[ "ami-22416367" = "ami-22416367" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-1" = "us-west-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-1-client-config-server-6: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-1-client-config-server-6: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-8638aebc
  arch: x86_64
  product: rhel
  region: ap-southeast-2
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-de5e58e4",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-8638aebc",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:35:22Z",\r\n  "availabilityZone" : "ap-southeast-2a",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.248.37.177",\r\n  "region" : "ap-southeast-2"\r\n}'']'}
        - {command: '[ "ami-8638aebc" = "ami-8638aebc" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-southeast-2" = "ap-southeast-2" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-2-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-2-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-e05e58da",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-8638aebc",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:35:18Z",\r\n  "availabilityZone" : "ap-southeast-2a",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.248.37.176",\r\n  "region" : "ap-southeast-2"\r\n}'']'}
        - {command: '[ "ami-8638aebc" = "ami-8638aebc" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-southeast-2" = "ap-southeast-2" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-2-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-2-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-ee501dbc
  arch: x86_64
  product: rhel
  region: ap-southeast-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-f1ea64a6",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-ee501dbc",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:36:56Z",\r\n  "availabilityZone" : "ap-southeast-1a",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.148.6.143",\r\n  "region" : "ap-southeast-1"\r\n}'']'}
        - {command: '[ "ami-ee501dbc" = "ami-ee501dbc" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-southeast-1" = "ap-southeast-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-c9ea649e",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-ee501dbc",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:36:53Z",\r\n  "availabilityZone" : "ap-southeast-1a",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.148.7.84",\r\n  "region" : "ap-southeast-1"\r\n}'']'}
        - {command: '[ "ami-ee501dbc" = "ami-ee501dbc" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "ap-southeast-1" = "ap-southeast-1" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-ap-southeast-1-client-config-server-6: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-ap-southeast-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-ap-southeast-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-e2f6ff96
  arch: x86_64
  product: rhel
  region: eu-west-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-e83099a2",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-e2f6ff96",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "cc2.8xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:58Z",\r\n  "availabilityZone" : "eu-west-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.36.1.205",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-e2f6ff96" = "ami-e2f6ff96" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '32',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cg1.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''23146704'']'}
        - {command: '[ 23146704 -gt 22000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-e03099aa",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-e2f6ff96",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "cg1.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:34:04Z",\r\n  "availabilityZone" : "eu-west-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.36.5.236",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-e2f6ff96" = "ami-e2f6ff96" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '16',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''23146704'']'}
        - {command: '[ 23146704 -gt 22000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62535708'']'}
        - {command: '[ 62535708 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-f83099b2",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-e2f6ff96",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "hi1.4xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:34:07Z",\r\n  "availabilityZone" : "eu-west-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.36.35.18",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-e2f6ff96" = "ami-e2f6ff96" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '16',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62535708'']'}
        - {command: '[ 62535708 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-ea3099a0",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-e2f6ff96",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:57Z",\r\n  "availabilityZone" : "eu-west-1b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.39.62.213",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-e2f6ff96" = "ami-e2f6ff96" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-d430999e",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-e2f6ff96",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:57Z",\r\n  "availabilityZone" : "eu-west-1a",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.33.181.72",\r\n  "region" : "eu-west-1"\r\n}'']'}
        - {command: '[ "ami-e2f6ff96" = "ami-e2f6ff96" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "eu-west-1" = "eu-west-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-eu-west-1-client-config-server-6: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-eu-west-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-eu-west-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-5a75ff6a
  arch: x86_64
  product: rhel
  region: us-west-2
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-bcdcbd8e",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-5a75ff6a",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "cc2.8xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:47Z",\r\n  "availabilityZone" : "us-west-2c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.244.67.29",\r\n  "region" : "us-west-2"\r\n}'']'}
        - {command: '[ "ami-5a75ff6a" = "ami-5a75ff6a" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-2" = "us-west-2" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: "/dev/xvda1\r\n/dev/xvdf"}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/mnt'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvdf'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext3'']'}
        - {command: '[ `df -k /dev/xvdf | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext3 = ext3 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '32',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''62533724'']'}
        - {command: '[ 62533724 -gt 60500000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-4edcbd7c",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-5a75ff6a",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.2xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:35Z",\r\n  "availabilityZone" : "us-west-2b",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.253.34.171",\r\n  "region" : "us-west-2"\r\n}'']'}
        - {command: '[ "ami-5a75ff6a" = "ami-5a75ff6a" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-2" = "us-west-2" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-48dcbd7a",\r\n  "billingProducts"
            : [ "bp-6fa54006" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-5a75ff6a",\r\n  "accountId"
            : "567014786890",\r\n  "instanceType" : "m3.xlarge",\r\n  "architecture"
            : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId" : null,\r\n  "pendingTime"
            : "2013-02-15T10:33:35Z",\r\n  "availabilityZone" : "us-west-2c",\r\n  "devpayProductCodes"
            : null,\r\n  "privateIp" : "10.245.2.210",\r\n  "region" : "us-west-2"\r\n}'']'}
        - {command: '[ "ami-5a75ff6a" = "ami-5a75ff6a" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "us-west-2" = "us-west-2" ]', result: passed}
        - {command: '[ "bp-6fa54006" = "bp-6fa54006" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-us-west-2-client-config-server-6: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional: {repo-status: enabled}
            rhui-us-west-2-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-us-west-2-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
- ami: ami-79da0164
  arch: x86_64
  product: rhel
  region: sa-east-1
  result:
    cc1.4xlarge: {create: failure}
    cc2.8xlarge: {create: failure}
    cg1.4xlarge: {create: failure}
    cr1.8xlarge: {create: failure}
    hi1.4xlarge: {create: failure}
    hs1.8xlarge: {create: failure}
    m3.2xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-90f4788e",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-79da0164",\r\n  "region"
            : "sa-east-1",\r\n  "accountId" : "567014786890",\r\n  "instanceType"
            : "m3.2xlarge",\r\n  "architecture" : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId"
            : null,\r\n  "pendingTime" : "2013-02-15T10:35:38Z",\r\n  "availabilityZone"
            : "sa-east-1b",\r\n  "devpayProductCodes" : null,\r\n  "privateIp" : "10.252.144.235"\r\n}'']'}
        - {command: '[ "ami-79da0164" = "ami-79da0164" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "sa-east-1" = "sa-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-sa-east-1-client-config-server-6: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-sa-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-sa-east-1-client-config-server-6: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-sa-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '8',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''30946476'']'}
        - {command: '[ 30946476 -gt 30000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
    m3.xlarge:
      stage1:
        testcase_01_ipv6:
        - {command: grep NETWORKING_IPV6=no /etc/sysconfig/network, result: passed}
        testcase_02_bash_history:
        - {command: '[ ! -f ~/.bash_history ] && echo 0 || cat ~/.bash_history | wc
            -l', expectation: "\r\n0\r\n", result: passed}
        testcase_03_chkconfig:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: chkconfig --list crond, expectation: '3:on', result: passed}
        - {command: chkconfig --list iptables, expectation: '3:on', result: passed}
        testcase_04_cloud_firstboot:
        - {command: chkconfig --list rh-cloud-firstboot, expectation: '3:off', result: passed}
        - {command: test -f /etc/sysconfig/rh-cloud-firstboot, result: passed}
        - {command: cat /etc/sysconfig/rh-cloud-firstboot, expectation: RUN_FIRSTBOOT=NO,
          result: passed}
        testcase_05_grub:
        - {command: test -h /boot/grub/menu.lst, result: passed}
        - {command: readlink -e /boot/grub/menu.lst, expectation: /boot/grub/grub.conf,
          result: passed}
        testcase_06_inittab:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'grep ''^id:'' /etc/inittab', expectation: 'id:3:initdefault',
          result: passed}
        testcase_07_libc6_xen_conf:
        - {command: test -f /etc/ld.so.conf.d/libc6-xen.conf, result: passed}
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_09_nameserver:
        - {command: dig clock.redhat.com | grep 66.187.233.4, result: passed}
        testcase_10_networking:
        - {command: grep '^NETWORKING=yes' /etc/sysconfig/network, result: passed}
        - {command: grep '^DEVICE=eth0' /etc/sysconfig/network-scripts/ifcfg-eth0,
          result: passed}
        testcase_11_package_set:
        - {command: 'rpm -qa --queryformat ''%{NAME},'' && echo', match: ".*\r\n(.*),\r\
            \n.*", result: passed, value: '[''latencytop,nss-sysinit,tzdata,selinux-policy-targeted,openldap,latencytop-common,cloud-init,rpm,iso-codes,cifs-utils,libuser,glibc,openssh-clients,logrotate,libcap,iwl1000-firmware,libsss_idmap,libcom_err,biosdevname,theora-tools,chkconfig,iwl100-firmware,libffi,nss-util,acpid,newt-python,libjpeg-turbo,prelink,python-ethtool,libsepol,ledmon,m2crypto,shadow-utils,abrt-cli,pygobject2,readline,dstat,python-rhsm,libuuid,elinks,sos,xmlrpc-c,pinfo,libproxy-python,tcp_wrappers-libs,pam_passwdqc,libreport,libogg,hunspell-en,abrt-addon-ccpp,libudev,valgrind,abrt-addon-kerneloops,dbus,mlocate,python-configobj,libtevent,latencytop-tui,python-krbV,cpio,libitm,PyYAML,libtirpc,scl-utils,python-nss,atk,zip,libipa_hbac-python,libtiff,eject,python-prettytable,lcms-libs,b43-fwcutter,python-boto,libldb,trace-cmd,libtasn1,cyrus-sasl-gssapi,ql23xx-firmware,plymouth-core-libs,libipa_hbac,xorg-x11-drv-ati-firmware,liboil,jasper-libs,iwl5000-firmware,ustr,e2fsprogs,ipw2100-firmware,libref_array,make,iwl4965-firmware,blktrace,libedit,gpg-pubkey,libpcap,perl-Pod-Escapes,perl-libwww-perl,perl-libs,poppler-data,perl-Test-Harness,fontpackages-filesystem,perl-Module-Load,policycoreutils,perl-IO-Compress-Base,util-linux-ng,perl-Compress-Zlib,device-mapper-libs,perl-Term-UI,usermode,perl-Test-Simple,libcgroup,perl-Module-Loaded,samba-winbind,libusb1,dmraid-events,openjpeg-libs,rhnsd,perl-IO-Compress-Bzip2,foomatic-db,perl-ExtUtils-Embed,crda,perl-CPANPLUS,ntpdate,perl-Time-Piece,yp-tools,tmpwatch,postfix,iw,redhat-lsb-core,tcp_wrappers,iptables-ipv6,db4-utils,libX11-common,patch,cairo,libnih,libXcursor,time,libXinerama,dash,ghostscript,less,redhat-lsb-printing,cracklib-dicts,mesa-libGL,fontconfig,libXv,qt,libXcomposite,xdg-utils,redhat-lsb-compat,pciutils,kbd-misc,ghostscript-fonts,kernel,bind-utils,hal,ConsoleKit,kexec-tools,sssd-client,libgcc,cvs,ca-certificates,nss,filesystem,nss-tools,tzdata-java,libcurl,foomatic-db-filesystem,curl,xml-common,rpm-libs,ncurses-base,man,glibc-common,passwd,ncurses-libs,nss_compat_ossl,libattr,jline,zlib,hicolor-icon-theme,libstdc++,gpm-libs,dbus-libs,SDL,popt,libpath_utils,nspr,libyaml,freetype,python-libs,libacl,rpm-python,libpng,python-iniparse,bzip2-libs,libxml2-python,libtalloc,python-dmidecode,libselinux,python-setuptools,glib2,python-dateutil,sed,libselinux-python,elfutils-libelf,pyOpenSSL,sqlite,python-gudev,dbus-glib,python-nose,libICE,python-pygments,libblkid,yum-metadata-parser,keyutils-libs,libproxy,libtdb,libreport-plugin-reportuploader,findutils,libreport-plugin-rhtsupport,xz-libs,libreport-python,procps,abrt,libidn,abrt-addon-python,libgpg-error,libreport-plugin-kerneloops,libcap-ng,libreport-cli,pciutils-libs,libreport-plugin-mailx,libgssglue,python-crypto,bzip2,setools-libs-python,grep,python-ldap,binutils,gettext,pkgconfig,pytalloc,libvorbis,pytz,lua,python-kerberos,tar,python-cheetah,net-tools,python-pycurl,e2fsprogs-libs,python-netaddr,dmidecode,pygpgme,libmng,rhn-client-tools,crash,python-argparse,libgudev1,libdhash,xz,gnutls,keyutils,samba4-libs,bc,libXau,checkpolicy,libvisual,vim-minimal,pixman,acl,sgpio,libss,libsemanage,gmp,libasyncns,diffutils,libini_config,m4,libaio,libfontenc,libthai,numactl,sg3_utils-libs,gdbm,ethtool,perl-Module-Pluggable,perl-version,perl,perl-Params-Check,perl-ExtUtils-ParseXS,perl-ExtUtils-MakeMaker,perl-Module-Load-Conditional,perl-Log-Message,perl-Compress-Raw-Zlib,perl-IO-Compress-Zlib,perl-IO-Zlib,perl-Log-Message-Simple,perl-Archive-Extract,perl-ExtUtils-CBuilder,perl-Object-Accessor,perl-Compress-Raw-Bzip2,perl-Digest-SHA,perl-Module-CoreList,libgfortran,newt,libcollection,perl-CPAN,perl-DBD-SQLite,perl-Module-Build,perl-HTML-Tagset,perl-Parse-CPAN-Meta,perl-Time-HiRes,perl-parent,libXfont,xz-lzma-compat,elfutils,gstreamer,hal-libs,flac,grubby,setools-libs,MAKEDEV,desktop-file-utils,device-mapper-persistent-data,portreserve,upstart,ed,libgomp,cdparanoia-libs,vim-common,groff,coreutils-libs,cracklib,coreutils,openssl,module-init-tools,hwdata,jpackage-utils,plymouth-scripts,redhat-logos,qt-sqlite,libpciaccess,urw-fonts,mysql-libs,bind-libs,fipscheck-lib,ConsoleKit-libs,polkit,at,seekwatcher,java-1.7.0-openjdk,dhclient,system-config-firewall-tui,sysstat,system-config-network-tui,lvm2,samba-client,openssh-server,setuptool,aic94xx-firmware,iwl6000-firmware,b43-openfwwf,bfa-firmware,iwl6000g2a-firmware,smartmontools,cpuspeed,readahead,rng-tools,perl-XML-Grove,tcpdump,yum-plugin-security,cas,libhugetlbfs-utils,iotop,vim-enhanced,gdb,man-pages-overrides,Red_Hat_Enterprise_Linux-Release_Notes-6-en-US,usbutils,perl-Crypt-SSLeay,tcsh,audit,perl-core,perl-XML-Dumper,irqbalance,oprofile,efibootmgr,ltrace,lsof,rsync,nano,nfs4-acl-tools,mcelog,mtr,bridge-utils,libtopology,traceroute,dosfstools,latrace,rfkill,vconfig,atmel-firmware,rt61pci-firmware,zd1211-firmware,libertas-usb8388-firmware,ql2200-firmware,ql2400-firmware,redhat-indexhtml,words,man-pages,ql2100-firmware,ipw2200-firmware,gpg-pubkey,mailcap,perl-XML-Parser,busybox,poppler,kernel-firmware,dejavu-fonts-common,redhat-release-server,iptables,iputils,initscripts,libdrm,device-mapper,cups,device-mapper-event,openssh,rsyslog,samba-winbind-clients,nfs-utils-lib,policycoreutils-python,dmraid,rhn-check,rhn-setup,foomatic-db-ppds,cryptsetup-luks-libs,plymouth,wireless-tools,mdadm,ntp,oddjob-mkhomedir,ypbind,cyrus-sasl,crontabs,cronie,certmonger,ipa-python,system-config-firewall-base,dhcp-common,libX11,libXrender,libXi,libXtst,libXrandr,pango,pulseaudio-libs,libXt,giflib,foomatic,qt3,libXxf86vm,mesa-dri1-drivers,mesa-libGLU,gstreamer-plugins-base,phonon-backend-gstreamer,gtk2,redhat-lsb-graphics,redhat-lsb,fprintd,kbd,dracut-kernel,autofs,hal-info,ipa-client,systemtap-runtime,fprintd-pam,krb5-workstation,setup,hwloc,mailx,mesa-dri-filesystem,subscription-manager,xmlrpc-c-client,basesystem,rh-amazon-rhui-client,gnupg2,nss-softokn-freebl,numad,gpgme,bash,parted,rhino,info,iwl5150-firmware,hdparm,libxml2,iwl6050-firmware,mingetty,audit-libs,microcode_ctl,python,gawk,quota,dbus-python,expat,perl-XML-Twig,authconfig,gamin,yum-utils,python-simplejson,db4,grub,rhnlib,cyrus-sasl-lib,perf,numpy,libSM,sudo,libproxy-bin,krb5-libs,alsa-utils,libreport-compat,btparser,psacct,abrt-libs,which,ntsysv,abrt-tui,libgcrypt,crash-gcore-command,libreport-plugin-logger,libnl,cyrus-sasl-plain,python-paramiko,pcre,unzip,python-lxml,file-libs,attr,audit-libs-python,elfutils-libs,powertop,python-markdown,psmisc,strace,python-urlgrabber,sysvinit-tools,setserial,yum,file,crash-trace-command,libsss_autofs,libtheora,rdate,cups-libs,nss-softokn,ql2500-firmware,libxcb,libselinux-utils,rootfiles,hesiod,avahi-libs,rt73usb-firmware,libsemanage-python,libusb,iwl3945-firmware,libevent,libtar,ivtv-firmware,pax,pth,c-ares,perl-Pod-Simple,perl-libxml-perl,perl-Locale-Maketext-Simple,poppler-utils,perl-devel,dejavu-sans-fonts,perl-IPC-Cmd,iproute,perl-Package-Constants,udev,perl-Archive-Tar,device-mapper-event-libs,perl-File-Fetch,kpartx,perl-DBI,samba-common,perl-URI,nfs-utils,slang,lvm2-libs,atlas,yum-rhn-plugin,perl-DBIx-Simple,cryptsetup-luks,perl-HTML-Parser,python-iwlib,perl-CGI,oddjob,xorg-x11-font-utils,sssd,gstreamer-tools,cronie-anacron,libxslt,virt-what,eggdbus,selinux-policy,libutempter,libXext,pinentry,libXfixes,hunspell,libXft,libhugetlbfs,libXdamage,ncurses,java-1.6.0-openjdk,gzip,pycairo,pam,mesa-dri-drivers,alsa-lib,qt-x11,libssh2,python-matplotlib,rpcbind,libfprint,libsndfile,dracut,wget,pm-utils,fipscheck,pcmciautils,pam_krb5'']'}
        - {comment: 'Newly introduced packages: [''PyYAML'', ''audit-libs-python'',
            ''cloud-init'', ''gpg-pubkey'', ''libselinux-python'', ''libsemanage-python'',
            ''libyaml'', ''policycoreutils-python'', ''python-argparse'', ''python-boto'',
            ''python-cheetah'', ''python-configobj'', ''python-markdown'', ''python-prettytable'',
            ''python-pygments'', ''redhat-lsb-compat'', ''rh-amazon-rhui-client'',
            ''setools-libs'', ''setools-libs-python'']', result: passed}
        - {comment: All required package are included, result: passed}
        testcase_12_passwd_group:
        - {command: 'grep ''^root:x:0:0:root:/root:/bin/bash'' /etc/passwd', result: passed}
        - {command: 'grep ''^nobody:x:99:99:Nobody:/:/sbin/nologin'' /etc/passwd',
          result: passed}
        - {command: 'grep ''^sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin''
            /etc/passwd', result: passed}
        - {command: 'grep ''^root:x:0:'' /etc/group', result: passed}
        - {command: 'grep ''^daemon:x:2:bin,daemon'' /etc/group', result: passed}
        - {command: 'grep ''^bin:x:1:bin,daemon'' /etc/group', result: passed}
        testcase_13_resize2fs: {comment: not applicable for virtualization = hvm,
          result: skipped}
        testcase_14_host_details:
        - {command: '[ ! -z "`curl http://169.254.169.254/latest/dynamic/instance-identity/signature`"
            ]', result: passed}
        - {command: 'curl http://169.254.169.254/latest/dynamic/instance-identity/document',
          match: '.*({.*}).*', result: passed, value: '[''{\r\n  "instanceId" : "i-92f4788c",\r\n  "billingProducts"
            : [ "bp-63a5400a" ],\r\n  "version" : "2010-08-31",\r\n  "imageId" : "ami-79da0164",\r\n  "region"
            : "sa-east-1",\r\n  "accountId" : "567014786890",\r\n  "instanceType"
            : "m3.xlarge",\r\n  "architecture" : "x86_64",\r\n  "kernelId" : null,\r\n  "ramdiskId"
            : null,\r\n  "pendingTime" : "2013-02-15T10:35:36Z",\r\n  "availabilityZone"
            : "sa-east-1b",\r\n  "devpayProductCodes" : null,\r\n  "privateIp" : "10.252.144.239"\r\n}'']'}
        - {command: '[ "ami-79da0164" = "ami-79da0164" ]', result: passed}
        - {command: '[ "x86_64" = "x86_64" ]', result: passed}
        - {command: '[ "sa-east-1" = "sa-east-1" ]', result: passed}
        - {command: '[ "bp-63a5400a" = "bp-63a5400a" ]', result: passed}
        testcase_15_rhel_version:
        - {command: 'rpm -q --qf ''%{RELEASE}

            '' --whatprovides redhat-release', match: ".*\r\n([0-9]\\.[0-9]\\..*)\r\
            \n.*", result: passed, value: '[''6.4.0.4.el6'']'}
        - {command: '[ ''6.4'' = ''6.4'' ]', result: passed}
        testcase_16_selinux:
        - {command: getenforce, expectation: "\r\nEnforcing\r\n", result: passed}
        - {command: grep '^SELINUX=enforcing' /etc/sysconfig/selinux, result: passed}
        - {command: grep '^SELINUXTYPE=targeted' /etc/sysconfig/selinux, result: passed}
        - {command: setenforce Permissive && getenforce, expectation: "\r\nPermissive\r\
            \n", result: passed}
        - {command: setenforce Enforcing && getenforce, expectation: "\r\nEnforcing\r\
            \n", result: passed}
        testcase_17_shells:
        - {command: grep 'bin/bash$' /etc/shells, result: passed}
        - {command: grep 'bin/nologin$' /etc/shells, result: passed}
        testcase_18_sshd:
        - {command: rpm -q systemd > /dev/null && echo True || echo False, result: passed,
          value: 'False'}
        - {command: 'chkconfig --list sshd | grep ''0:off[[:space:]]*1:off[[:space:]]*2:on[[:space:]]*3:on[[:space:]]*4:on[[:space:]]*5:on[[:space:]]*6:off''',
          result: passed}
        - {command: service sshd status | grep running, result: passed}
        - {command: grep 'PasswordAuthentication no' /etc/ssh/sshd_config, result: passed}
        testcase_19_rhn_system_id:
        - {command: '[ ! -f /etc/sysconfig/rhn/systemid ]', result: passed}
        testcase_20_auditd:
        - {command: md5sum /etc/audit/auditd.conf | cut -f 1 -d ' ', expectation: e1886162554c18906df2ecd258aa4794,
          result: passed}
        - {command: md5sum /etc/sysconfig/auditd  | cut -f 1 -d ' ', expectation: d4d43637708e30418c30003e212f76fc,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        - {command: md5sum /etc/audit/audit.rules | cut -f 1 -d ' ', expectation: f9869e1191838c461f5b9051c78a638d,
          result: passed}
        - {command: chkconfig --list auditd, expectation: '3:on.*5:on', result: passed}
        testcase_21_disk_size_format:
        - {command: 'mount | grep ''^/dev'' | awk ''{print $1}''', result: passed,
          value: /dev/xvda1}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $3}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''/'']'}
        - {command: 'echo ''###'' ;mount | grep ''^/dev/xvda1'' | awk ''{print $5}'';
            echo ''###''', match: ".*\r\n###\r\n(.*)\r\n###\r\n.*", result: passed,
          value: '[''ext4'']'}
        - {command: '[ `df -k /dev/xvda1 | awk ''{ print $2 }'' | tail -n 1` -gt 3937219
            ]', result: passed}
        - {command: '[ ext4 = ext4 ]', result: passed}
        testcase_22_gpg_keys:
        - {command: grep '^gpgcheck=' /etc/yum.repos.d/redhat-*.repo | cut -d\= -f2
            | sort -uf | tr -d ' ', expectation: "\r\n1\r\n", result: passed}
        - {command: rpm -qa gpg-pubkey* | wc -l, expectation: "\r\n2\r\n", result: passed}
        - {command: rpm -q gpg-pubkey-2fa658e0-45700c69, result: passed}
        - {command: rpm -q gpg-pubkey-fd431d51-4ae0493b, result: passed}
        testcase_23_syslog:
        - {command: md5sum /etc/rsyslog.conf | cut -f 1 -d ' ', result: passed, value: 8b91b32300134e98ef4aee632ed61e21}
        - {command: '[ 8b91b32300134e98ef4aee632ed61e21 = 8b91b32300134e98ef4aee632ed61e21
            ]', result: passed}
        testcase_24_yum_plugin:
        - {command: 'grep ''^enabled[[:space:]]*=[[:space:]]*[^0 ]'' /etc/yum/pluginconf.d/rhnplugin.conf',
          result: passed}
        testcase_27_yum_repos:
        - {command: 'yum repolist -v all | csplit --prefix=repolist_xx - "%Repo-id\s*:%"',
          result: passed}
        - actual repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-sa-east-1-client-config-server-6: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-sa-east-1-rhel-server-releases-source: {repo-status: disabled}
          expected repos:
            rhel-source: {repo-status: disabled}
            rhel-source-beta: {repo-status: disabled}
            rhui-sa-east-1-client-config-server-6: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional: {repo-status: enabled}
            rhui-sa-east-1-rhel-server-releases-optional-source: {repo-status: disabled}
            rhui-sa-east-1-rhel-server-releases-source: {repo-status: disabled}
          result: passed
        testcase_28_iptables:
        - {command: 'iptables -L -n | grep :22 | grep ACCEPT | wc -l', expectation: "\r\n\
            1\r\n", result: passed}
        - {command: 'iptables -L -n | grep RELATED,ESTABLISHED | grep ACCEPT | wc
            -l', expectation: "\r\n1\r\n", result: passed}
        - {command: iptables -L -n | grep REJECT | grep all | grep 0.0.0.0/0 | grep
            icmp-host-prohibited | wc -l, expectation: "\r\n2\r\n", result: passed}
        testcase_29_swap_file: {comment: not applicable for arch = x86_64, result: skipped}
        testcase_32_ephemeral:
        - {comment: no ephemeral devices in block map, result: skip}
        testcase_33_userdata:
        - {command: 'rpm -q --queryformat ''%{NAME}

            '' cloud-init', result: passed, value: cloud-init}
        - {command: ls -l /userdata_test, result: passed}
        testcase_34_cpu:
        - {command: cat /proc/cpuinfo | grep '^processor' | wc -l, expectation: '4',
          result: passed}
        testcase_35_console:
        - {command: grep 'console=ttyS0' /proc/cmdline, result: passed}
        testcase_50_yum_package_install:
        - {command: yum repolist, result: passed}
        - {command: yum search zsh, result: passed}
        - {command: yum -y install zsh, result: passed}
        - {command: 'rpm -q --queryformat ''%{NAME}'' zsh', result: passed}
        - {command: rpm -e zsh, result: passed}
        testcase_60_yum_update:
        - {command: yum -y update, result: passed}
        testcase_61_yum_proxy:
        - {comment: No proxy set, result: skip}
        testcase_99_reboot:
        - {command: echo 'doing reboot', result: passed}
      stage2:
        testcase_08_memory:
        - {command: 'grep --color=none ''MemTotal:'' /proc/meminfo', match: ".*\r\n\
            MemTotal:\\s*([0-9]+) ", result: passed, value: '[''15433444'']'}
        - {command: '[ 15433444 -gt 15000000 ]', result: passed}
        testcase_25_uname:
        - {command: uname -r, result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: 'rpm -q --queryformat ''%{VERSION}-%{RELEASE}.%{ARCH}

            '' kernel | sort | tail -1', result: passed, value: 2.6.32-358.el6.x86_64}
        - {command: uname -o, result: passed, value: GNU/Linux}
        - {command: '[ 2.6.32-358.el6.x86_64 = 2.6.32-358.el6.x86_64 ]', result: passed}
        - {command: '[ GNU/Linux = ''GNU/Linux'' ]', result: passed}
        - {command: grep UPDATEDEFAULT=yes /etc/sysconfig/kernel, result: passed}
        - {command: grep DEFAULTKERNEL=kernel /etc/sysconfig/kernel, result: passed}
  version: '6.4'
